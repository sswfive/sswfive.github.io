<<<<<<< HEAD
<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="è¿›ç¨‹ç®¡ç†å·¥å…·ä¹‹Supervisor" />
    <meta name="hexo-theme-A4" content="v1.9.7" />
    <link rel="alternate icon" type="image/webp" href="/img/head.png">
    <title>PyShen</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #e4e4e4 ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: 'ğŸŒ“', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <style>
            .header-img {
                width: 56px;
                height: auto;
                object-fit: cover; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ */
                transition: transform 0.3s ease-in-out; 
                border-radius: 0; 
            }
            
        </style>
        <img 
            alt="^-^" 
            cache-control="max-age=86400" 
            class="header-img" 
            src="/img/head.png" 
        />
        <div class="header-content">
            <a class="logo" href="/">PyShen</a> 
            <span class="description"></span> 
        </div>
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/about/">å…³äº</a></li>
            
        
            
                <li><a href="/tags/">æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    è¿›ç¨‹ç®¡ç†å·¥å…·ä¹‹Supervisor
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>æœ€è¿‘æ›´æ–°ï¼š2025-03-05</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>å­—æ•°æ€»è®¡ï¼š6.5k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>é˜…è¯»ä¼°æ—¶ï¼š26åˆ†é’Ÿ</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        é˜…è¯»é‡ï¼š<span id="busuanzi_value_page_pv"></span>æ¬¡
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A6%82%E8%BF%B0%EF%BC%9A"><span class="post-toc-text">æ¦‚è¿°ï¼š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="post-toc-text">ä½¿ç”¨ï¼š</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%89%E8%A3%85"><span class="post-toc-text">å®‰è£…</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="post-toc-text">å¸¸ç”¨å‘½ä»¤ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="post-toc-text">å¿«é€Ÿä½¿ç”¨ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E8%AF%BB%EF%BC%9A"><span class="post-toc-text">é…ç½®æ–‡ä»¶è§£è¯»ï¼š</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E8%A7%A3%E8%AF%BB"><span class="post-toc-text">å¸¸ç”¨é…ç½®è§£è¯»</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE%E8%A7%A3%E8%AF%BB%EF%BC%9A"><span class="post-toc-text">è¯¦ç»†é…ç½®è§£è¯»ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Supervisor%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="post-toc-text">Supervisoræ§åˆ¶å°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%86%E7%BB%84%E7%AE%A1%E7%90%86"><span class="post-toc-text">åˆ†ç»„ç®¡ç†</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Supervisor%E9%85%8D%E7%BD%AE%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8"><span class="post-toc-text">Supervisoré…ç½®å¼€æœºå¯åŠ¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A"><span class="post-toc-text">æ–¹å¼ä¸€ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A"><span class="post-toc-text">æ–¹å¼äºŒï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B"><span class="post-toc-text">é…ç½®æ¡ˆä¾‹:</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Django%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">Djangoçš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Celery%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">Celeryçš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">Redisçš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#tomcat%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">tomcatçš„é…ç½®æ–‡ä»¶</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%86%E7%BB%84%E7%AE%A1%E7%90%86%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="post-toc-text">å¸¸è§é—®é¢˜ï¼š</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%981%EF%BC%9Aunix-tmp-supervisor-sock-no-such-file%E7%9A%84%E9%97%AE%E9%A2%98"><span class="post-toc-text">é—®é¢˜1ï¼šunix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock no such fileçš„é—®é¢˜</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%982%EF%BC%9Acommand%E4%B8%AD%E6%8C%87%E5%AE%9A%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%B7%B2%E7%BB%8F%E8%B5%B7%E6%9D%A5%EF%BC%8C%E4%BD%86supervisor%E8%BF%98%E4%B8%8D%E6%96%AD%E9%87%8D%E5%90%AF"><span class="post-toc-text">é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%983%EF%BC%9A%E5%90%AF%E5%8A%A8%E4%BA%86%E5%A4%9A%E4%B8%AAsupervisord%E6%9C%8D%E5%8A%A1%EF%BC%8C%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E5%85%B3%E9%97%AD%E6%9C%8D%E5%8A%A1"><span class="post-toc-text">é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡</span></a></li></ol></li></ol>
            
        
        <div class=".article-gallery"><h2 id="æ¦‚è¿°ï¼š">æ¦‚è¿°ï¼š</h2>
<blockquote>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="http://supervisord.org/">http://supervisord.org/</a></p>
</blockquote>
<p>supervisoræ˜¯ç”¨pythonå¼€å‘çš„ä¸€æ¬¾ç”¨äºlinuxæ“ä½œç³»ç»Ÿçš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œsupervisorå¯ä»¥é«˜æ•ˆåœ°å®ç°å¯¹è¿›ç¨‹çŠ¶æ€çš„ç›‘æ§åŠç»Ÿä¸€ç®¡ç†</p>
<ul>
<li>supervisoråˆ†ä¸ºsupervisordï¼ˆæœåŠ¡ç«¯ï¼‰å’Œsupervisorctlï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸¤éƒ¨åˆ†</li>
<li>supervisordä½œä¸ºæœåŠ¡ç«¯è´Ÿè´£æ‰€æœ‰çš„æ³¨å†Œè¿›ç¨‹çš„å¯åŠ¨åŠç›‘æ§ï¼Œå‡ºç°å´©æºƒçš„æœåŠ¡æ—¶ä¼šè‡ªåŠ¨é‡å¯</li>
<li>supervisorctlæ˜¯å®¢æˆ·ç«¯ï¼Œå¯ä»¥å®ç°å¯¹å­è¿›ç¨‹çš„ç®¡ç†ï¼Œå¦‚å¯åŠ¨ã€åœæ­¢ã€é‡å¯ç­‰</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>supervisord è¦æ±‚ç®¡ç†çš„ç¨‹åºæ˜¯é daemon ç¨‹åºï¼Œ å› æ­¤ç”¨supervisord æ¥ç®¡ç†è¿›ç¨‹ï¼Œè¿›ç¨‹éœ€è¦ä»¥édaemonçš„æ–¹å¼å¯åŠ¨ã€‚
<ul>
<li>ä¾‹å¦‚ï¼šç®¡ç†nginxï¼Œå¿…é¡»åœ¨ nginx çš„é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä¸€è¡Œè®¾ç½® daemon off è®© nginx ä»¥é daemon æ–¹å¼å¯åŠ¨ã€‚</li>
</ul>
</li>
<li>æ¯æ¬¡ä¿®æ”¹é…ç½®æ–‡ä»¶åéœ€è¿›å…¥ supervisorctlï¼Œæ‰§è¡Œ reloadï¼Œ æ”¹åŠ¨éƒ¨åˆ†æ‰èƒ½ç”Ÿæ•ˆã€‚</li>
</ul>
<h2 id="ä½¿ç”¨ï¼š">ä½¿ç”¨ï¼š</h2>
<h3 id="å®‰è£…">å®‰è£…</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install supervisor</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆé…ç½®æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ï¼ˆæ­¤å¤„è·¯å¾„æŒ‡å®šä¸ºäº†/etc/supervisord.confï¼‰</span></span><br><span class="line">echo_supervisord_conf &gt; /etc/supervisord.conf</span><br></pre></td></tr></table></figure>
<h3 id="å¸¸ç”¨å‘½ä»¤ï¼š">å¸¸ç”¨å‘½ä»¤ï¼š</h3>
<ul>
<li>supervisord: æœåŠ¡ç«¯å‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">supervisord -c /etc/supervisord.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦åœ¨è¿è¡Œ</span></span><br><span class="line">ps aux | grep supervisord</span><br></pre></td></tr></table></figure>
<ul>
<li>supervisorctl: å®¢æˆ·ç«¯å‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl status                         <span class="comment"># æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line">supervisorctl start program_name             <span class="comment"># å¯åŠ¨program_nameè¿›ç¨‹</span></span><br><span class="line">supervisorctl stop program_name              <span class="comment"># ç»ˆæ­¢program_nameè¿›ç¨‹</span></span><br><span class="line">supervisorctl restart program_name           <span class="comment"># é‡å¯program_nameè¿›ç¨‹</span></span><br><span class="line">supervisorctl reread                         <span class="comment"># æ›´æ–°é…ç½®ï¼Œæ ¹æ®æœ€æ–°çš„é…ç½®å¯åŠ¨æ‰€æœ‰ç¨‹åº</span></span><br><span class="line">supervisorctl update                         <span class="comment"># æ›´æ–°é…ç½®ï¼Œé‡å¯é…ç½®æœ‰å˜åŒ–çš„è¿›ç¨‹</span></span><br></pre></td></tr></table></figure>
<ul>
<li>supervisorctl: shellå‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl                <span class="comment"># è¿›å…¥shellå‘½ä»¤è¡Œ</span></span><br><span class="line">&gt; status                     <span class="comment"># æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line">&gt; start program_name         <span class="comment"># å¯åŠ¨program_nameè¿›ç¨‹</span></span><br><span class="line">&gt; stop program_name          <span class="comment"># ç»ˆæ­¢program_nameè¿›ç¨‹</span></span><br><span class="line">&gt; restart program_name       <span class="comment"># é‡å¯program_nameè¿›ç¨‹</span></span><br><span class="line">&gt; reread                     <span class="comment"># æ›´æ–°é…ç½®ï¼Œæ ¹æ®æœ€æ–°çš„é…ç½®å¯åŠ¨æ‰€æœ‰ç¨‹åº</span></span><br><span class="line">&gt; update                     <span class="comment"># æ›´æ–°é…ç½®ï¼Œé‡å¯é…ç½®æœ‰å˜åŒ–çš„è¿›ç¨‹</span></span><br><span class="line">&gt; start fastapi:*            <span class="comment"># å¯åŠ¨ fastapiç»„ ç¨‹åº</span></span><br><span class="line">&gt; stop fastapi:*             <span class="comment"># åœæ­¢ fastapiç»„ ç¨‹åº</span></span><br></pre></td></tr></table></figure>
<h3 id="å¿«é€Ÿä½¿ç”¨ï¼š">å¿«é€Ÿä½¿ç”¨ï¼š</h3>
<ul>
<li>step1ï¼šç¼–è¾‘supervisoré…ç½®æ–‡ä»¶
<ul>
<li>åœ¨é…ç½®æ–‡ä»¶çš„æœ«å°¾åŠ ä¸Š[include]å†…å®¹</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">[include]</span><br><span class="line">files=/etc/supervisor.d/*.conf  <span class="comment">#è‹¥ä½ æœ¬åœ°æ— /etc/supervisor.dç›®å½•ï¼Œè¯·è‡ªå»º</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ul>
<li>step2ï¼šæ–°å»º/etc/supervisor.d/.demo.conf é…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[program:è‡ªå®šä¹‰çš„æœåŠ¡åç§°]</span><br><span class="line"><span class="built_in">command</span>=python3 /xxxx/main.py  <span class="comment">#æœåŠ¡çš„å¯åŠ¨å‘½ä»¤ï¼Œåœ¨è¿™é‡Œç”¨çš„pythonç¯å¢ƒä¸ºsupervisorå®‰è£…çš„ç¯å¢ƒï¼Œè‹¥æƒ³æŒ‡å®šå…¶ä»–pythonç¯å¢ƒåˆ™å¯æŒ‡å®špythonåŒ…çš„ä½ç½®å¦‚command=xxxx/xxxx/bin/python3 /xxxx/main.pyä¾¿å¯</span></span><br><span class="line">process_name=%(program_name)s</span><br><span class="line">stdout_logfile=/home/task.log  <span class="comment">#è¾“å‡ºæ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå¯æ ¹æ®éœ€è¦è‡ªå®šä¹‰</span></span><br><span class="line">stderr_logfile=/home/task.log  <span class="comment">#æŠ¥é”™æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå¯æ ¹æ®éœ€è¦è‡ªå®šä¹‰</span></span><br></pre></td></tr></table></figure>
<ul>
<li>step3:å¯åŠ¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">supervisord -c /etc/supervisor.conf</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®æ–‡ä»¶è§£è¯»ï¼š">é…ç½®æ–‡ä»¶è§£è¯»ï¼š</h2>
<h3 id="å¸¸ç”¨é…ç½®è§£è¯»">å¸¸ç”¨é…ç½®è§£è¯»</h3>
<ul>
<li>æ‰“å¼€é…ç½®æ–‡ä»¶ï¼š /etc/supervisord.conf</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[unix_http_server]</span><br><span class="line">file=/tmp/supervisor.sock   ;UNIX socket æ–‡ä»¶ï¼Œsupervisorctl ä¼šä½¿ç”¨</span><br><span class="line">;<span class="built_in">chmod</span>=0700                 ;socketæ–‡ä»¶çš„modeï¼Œé»˜è®¤æ˜¯0700</span><br><span class="line">;<span class="built_in">chown</span>=nobody:nogroup       ;socketæ–‡ä»¶çš„ownerï¼Œæ ¼å¼ï¼šuid:gid</span><br><span class="line"></span><br><span class="line">[inet_http_server]         ;HTTPæœåŠ¡å™¨ï¼Œæä¾›webç®¡ç†ç•Œé¢</span><br><span class="line">port=0.0.0.0:9001          ;Webç®¡ç†åå°è¿è¡Œçš„IPå’Œç«¯å£ï¼Œå¦‚æœå¼€æ”¾åˆ°å…¬ç½‘ï¼Œéœ€è¦æ³¨æ„å®‰å…¨æ€§</span><br><span class="line">username=user              ;ç™»å½•ç®¡ç†åå°çš„ç”¨æˆ·å</span><br><span class="line">password=123               ;ç™»å½•ç®¡ç†åå°çš„å¯†ç </span><br><span class="line"></span><br><span class="line">[supervisord]</span><br><span class="line">logfile=/tmp/supervisord.log ;æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ <span class="variable">$CWD</span>/supervisord.log</span><br><span class="line">logfile_maxbytes=50MB        ;æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºä¼šrotateï¼Œé»˜è®¤ 50MBï¼Œå¦‚æœè®¾æˆ0ï¼Œè¡¨ç¤ºä¸é™åˆ¶å¤§å°</span><br><span class="line">logfile_backups=10           ;æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤‡ä»½æ•°é‡é»˜è®¤10ï¼Œè®¾ä¸º0è¡¨ç¤ºä¸å¤‡ä»½</span><br><span class="line">loglevel=info                ;æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤infoï¼Œå…¶å®ƒ: debug,warn,trace</span><br><span class="line">pidfile=/tmp/supervisord.pid ;pid æ–‡ä»¶</span><br><span class="line">nodaemon=<span class="literal">false</span>               ;æ˜¯å¦åœ¨å‰å°å¯åŠ¨ï¼Œé»˜è®¤æ˜¯<span class="literal">false</span>ï¼Œå³ä»¥ daemon çš„æ–¹å¼å¯åŠ¨</span><br><span class="line">minfds=1024                  ;å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„æœ€å°å€¼ï¼Œé»˜è®¤ 1024</span><br><span class="line">minprocs=200                 ;å¯ä»¥æ‰“å¼€çš„è¿›ç¨‹æ•°çš„æœ€å°å€¼ï¼Œé»˜è®¤ 200</span><br><span class="line"></span><br><span class="line">[supervisorctl]</span><br><span class="line">serverurl=unix:///tmp/supervisor.sock ;é€šè¿‡UNIX socketè¿æ¥supervisordï¼Œè·¯å¾„ä¸unix_http_serveréƒ¨åˆ†çš„fileä¸€è‡´</span><br><span class="line">;serverurl=http://127.0.0.1:9001 ; é€šè¿‡HTTPçš„æ–¹å¼è¿æ¥supervisord</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸Šä¸œè¥¿éƒ½ä¸éœ€è¦æ”¹ï¼Œå°±åŠ ä¸‹é¢è¿™è¡Œ</span></span><br><span class="line">[include]</span><br><span class="line">files=/etc/supervisor.d/*.conf  <span class="comment">#è‹¥ä½ æœ¬åœ°æ— /etc/supervisor.dç›®å½•ï¼Œè¯·è‡ªå»º</span></span><br></pre></td></tr></table></figure>
<h3 id="è¯¦ç»†é…ç½®è§£è¯»ï¼š">è¯¦ç»†é…ç½®è§£è¯»ï¼š</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br></pre></td><td class="code"><pre><span class="line">[unix_http_server]            </span><br><span class="line"> </span><br><span class="line">file=/tmp/supervisor.sock   ; socketæ–‡ä»¶çš„è·¯å¾„ï¼Œsupervisorctlç”¨XML_RPCå’Œsupervisordé€šä¿¡å°±æ˜¯é€šè¿‡å®ƒè¿›è¡Œ</span><br><span class="line"> </span><br><span class="line">                              çš„ã€‚å¦‚æœä¸è®¾ç½®çš„è¯ï¼Œsupervisorctlä¹Ÿå°±ä¸èƒ½ç”¨äº†  </span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºnoneã€‚ éå¿…é¡»è®¾ç½®        </span><br><span class="line"> </span><br><span class="line">;<span class="built_in">chmod</span>=0700                 ; è¿™ä¸ªç®€å•ï¼Œå°±æ˜¯ä¿®æ”¹ä¸Šé¢çš„é‚£ä¸ªsocketæ–‡ä»¶çš„æƒé™ä¸º0700</span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸º0700ã€‚ éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">chown</span>=nobody:nogroup       ; è¿™ä¸ªä¸€æ ·ï¼Œä¿®æ”¹ä¸Šé¢çš„é‚£ä¸ªsocketæ–‡ä»¶çš„å±ç»„ä¸ºuser.group</span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºå¯åŠ¨supervisordè¿›ç¨‹çš„ç”¨æˆ·åŠå±ç»„ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;username=user              ; ä½¿ç”¨supervisorctlè¿æ¥çš„æ—¶å€™ï¼Œè®¤è¯çš„ç”¨æˆ·</span><br><span class="line"> </span><br><span class="line">                               ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºä¸éœ€è¦ç”¨æˆ·ã€‚ éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;password=123               ; å’Œä¸Šé¢çš„ç”¨æˆ·åå¯¹åº”çš„å¯†ç ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æ˜ç ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨SHAåŠ å¯†</span><br><span class="line"> </span><br><span class="line">                              å¦‚ï¼š&#123;SHA&#125;82ab876d1387bfafe46cc1c8a2ef074eae50cb1d</span><br><span class="line"> </span><br><span class="line">                              é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;[inet_http_server]         ; ä¾¦å¬åœ¨TCPä¸Šçš„socketï¼ŒWeb Serverå’Œè¿œç¨‹çš„supervisorctléƒ½è¦ç”¨åˆ°ä»–</span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºä¸å¼€å¯ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;port=127.0.0.1:9001        ; è¿™ä¸ªæ˜¯ä¾¦å¬çš„IPå’Œç«¯å£ï¼Œä¾¦å¬æ‰€æœ‰IPç”¨ :9001æˆ–*:9001ã€‚</span><br><span class="line"> </span><br><span class="line">                              è¿™ä¸ªå¿…é¡»è®¾ç½®ï¼Œåªè¦ä¸Šé¢çš„[inet_http_server]å¼€å¯äº†ï¼Œå°±å¿…é¡»è®¾ç½®å®ƒ</span><br><span class="line"> </span><br><span class="line">;username=user              ; è¿™ä¸ªå’Œä¸Šé¢çš„uinx_http_serverä¸€ä¸ªæ ·ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;password=123               ; è¿™ä¸ªä¹Ÿä¸€ä¸ªæ ·ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">[supervisord]                ;è¿™ä¸ªä¸»è¦æ˜¯å®šä¹‰supervisordè¿™ä¸ªæœåŠ¡ç«¯è¿›ç¨‹çš„ä¸€äº›å‚æ•°çš„</span><br><span class="line"> </span><br><span class="line">                              è¿™ä¸ªå¿…é¡»è®¾ç½®ï¼Œä¸è®¾ç½®ï¼Œsupervisorå°±ä¸ç”¨å¹²æ´»äº†</span><br><span class="line"> </span><br><span class="line">logfile=/tmp/supervisord.log ; è¿™ä¸ªæ˜¯supervisordè¿™ä¸ªä¸»è¿›ç¨‹çš„æ—¥å¿—è·¯å¾„ï¼Œæ³¨æ„å’Œå­è¿›ç¨‹çš„æ—¥å¿—ä¸æ­å˜ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤è·¯å¾„<span class="variable">$CWD</span>/supervisord.logï¼Œ<span class="variable">$CWD</span>æ˜¯å½“å‰ç›®å½•ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">logfile_maxbytes=50MB        ; è¿™ä¸ªæ˜¯ä¸Šé¢é‚£ä¸ªæ—¥å¿—æ–‡ä»¶çš„æœ€å¤§çš„å¤§å°ï¼Œå½“è¶…è¿‡50Mçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ—¥ </span><br><span class="line"> </span><br><span class="line">                               å¿—æ–‡ä»¶ã€‚å½“è®¾ç½®ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸é™åˆ¶æ–‡ä»¶å¤§å°</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤å€¼æ˜¯50Mï¼Œéå¿…é¡»è®¾ç½®ã€‚              </span><br><span class="line"> </span><br><span class="line">logfile_backups=10           ; æ—¥å¿—æ–‡ä»¶ä¿æŒçš„æ•°é‡ï¼Œä¸Šé¢çš„æ—¥å¿—æ–‡ä»¶å¤§äº50Mæ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°æ–‡ä»¶ã€‚æ–‡ä»¶</span><br><span class="line"> </span><br><span class="line">                               æ•°é‡å¤§äº10æ—¶ï¼Œæœ€åˆçš„è€æ–‡ä»¶è¢«æ–°æ–‡ä»¶è¦†ç›–ï¼Œæ–‡ä»¶æ•°é‡å°†ä¿æŒä¸º10</span><br><span class="line"> </span><br><span class="line">                               å½“è®¾ç½®ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸é™åˆ¶æ–‡ä»¶çš„æ•°é‡ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æƒ…å†µä¸‹ä¸º10ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">loglevel=info                ; æ—¥å¿—çº§åˆ«ï¼Œæœ‰critical, error, warn, info, debug, trace, or blatherç­‰</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸ºinfoã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">pidfile=/tmp/supervisord.pid ; supervisordçš„pidæ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º<span class="variable">$CWD</span>/supervisord.pidã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">nodaemon=<span class="literal">false</span>               ; å¦‚æœæ˜¯<span class="literal">true</span>ï¼Œsupervisordè¿›ç¨‹å°†åœ¨å‰å°è¿è¡Œ</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º<span class="literal">false</span>ï¼Œä¹Ÿå°±æ˜¯åå°ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">minfds=1024                  ; è¿™ä¸ªæ˜¯æœ€å°‘ç³»ç»Ÿç©ºé—²çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä½äºè¿™ä¸ªå€¼supervisorå°†ä¸ä¼šå¯åŠ¨ã€‚</span><br><span class="line"> </span><br><span class="line">                               ç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦åœ¨è¿™é‡Œè®¾ç½®<span class="built_in">cat</span> /proc/sys/fs/file-max</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æƒ…å†µä¸‹ä¸º1024ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">minprocs=200                 ; æœ€å°å¯ç”¨çš„è¿›ç¨‹æè¿°ç¬¦ï¼Œä½äºè¿™ä¸ªå€¼supervisorä¹Ÿå°†ä¸ä¼šæ­£å¸¸å¯åŠ¨ã€‚</span><br><span class="line"> </span><br><span class="line">                              <span class="built_in">ulimit</span>  -uè¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹linuxä¸‹é¢ç”¨æˆ·çš„æœ€å¤§è¿›ç¨‹æ•°</span><br><span class="line"> </span><br><span class="line">                              é»˜è®¤ä¸º200ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">umask</span>=022                   ; è¿›ç¨‹åˆ›å»ºæ–‡ä»¶çš„æ©ç </span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º022ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;user=chrism                 ; è¿™ä¸ªå‚æ•°å¯ä»¥è®¾ç½®ä¸€ä¸ªérootç”¨æˆ·ï¼Œå½“æˆ‘ä»¬ä»¥rootç”¨æˆ·å¯åŠ¨supervisordä¹‹åã€‚</span><br><span class="line"> </span><br><span class="line">                               æˆ‘è¿™é‡Œé¢è®¾ç½®çš„è¿™ä¸ªç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥å¯¹supervisordè¿›è¡Œç®¡ç†</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æƒ…å†µæ˜¯ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;identifier=supervisor       ; è¿™ä¸ªå‚æ•°æ˜¯supervisordçš„æ ‡è¯†ç¬¦ï¼Œä¸»è¦æ˜¯ç»™XML_RPCç”¨çš„ã€‚å½“ä½ æœ‰å¤šä¸ª</span><br><span class="line"> </span><br><span class="line">                               supervisorçš„æ—¶å€™ï¼Œè€Œä¸”æƒ³è°ƒç”¨XML_RPCç»Ÿä¸€ç®¡ç†ï¼Œå°±éœ€è¦ä¸ºæ¯ä¸ª</span><br><span class="line"> </span><br><span class="line">                               supervisorè®¾ç½®ä¸åŒçš„æ ‡è¯†ç¬¦äº†</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æ˜¯supervisordã€‚ã€‚ã€‚éå¿…éœ€è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;directory=/tmp              ; è¿™ä¸ªå‚æ•°æ˜¯å½“supervisordä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°çš„è¯ï¼Œå¯åŠ¨</span><br><span class="line"> </span><br><span class="line">                               supervisordè¿›ç¨‹ä¹‹å‰ï¼Œä¼šå…ˆåˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;nocleanup=<span class="literal">true</span>              ; è¿™ä¸ªå‚æ•°å½“ä¸º<span class="literal">false</span>çš„æ—¶å€™ï¼Œä¼šåœ¨supervisordè¿›ç¨‹å¯åŠ¨çš„æ—¶å€™ï¼ŒæŠŠä»¥å‰å­è¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                               äº§ç”Ÿçš„æ—¥å¿—æ–‡ä»¶(è·¯å¾„ä¸ºAUTOçš„æƒ…å†µä¸‹)æ¸…é™¤æ‰ã€‚æœ‰æ—¶å€™å’±ä»¬æƒ³è¦çœ‹å†å²æ—¥å¿—ï¼Œå½“ </span><br><span class="line"> </span><br><span class="line">                               ç„¶ä¸æƒ³æ—¥å¿—è¢«æ¸…é™¤äº†ã€‚æ‰€ä»¥å¯ä»¥è®¾ç½®ä¸º<span class="literal">true</span></span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æ˜¯<span class="literal">false</span>ï¼Œæœ‰è°ƒè¯•éœ€æ±‚çš„åŒå­¦å¯ä»¥è®¾ç½®ä¸º<span class="literal">true</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;childlogdir=/tmp            ; å½“å­è¿›ç¨‹æ—¥å¿—è·¯å¾„ä¸ºAUTOçš„æ—¶å€™ï¼Œå­è¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤è·¯å¾„æ˜¯è¿™ä¸ªä¸œè¥¿ï¼Œæ‰§è¡Œä¸‹é¢çš„è¿™ä¸ªå‘½ä»¤çœ‹çœ‹å°±OKäº†ï¼Œå¤„ç†çš„ä¸œè¥¿å°±é»˜è®¤è·¯å¾„</span><br><span class="line"> </span><br><span class="line">                               python -c <span class="string">&quot;import tempfile;print tempfile.gettempdir()&quot;</span></span><br><span class="line"> </span><br><span class="line">                               éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;environment=KEY=<span class="string">&quot;value&quot;</span>     ; è¿™ä¸ªæ˜¯ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡çš„ï¼Œsupervisordåœ¨linuxä¸­å¯åŠ¨é»˜è®¤ç»§æ‰¿äº†linuxçš„</span><br><span class="line"> </span><br><span class="line">                               ç¯å¢ƒå˜é‡ï¼Œåœ¨è¿™é‡Œå¯ä»¥è®¾ç½®supervisordè¿›ç¨‹ç‰¹æœ‰çš„å…¶ä»–ç¯å¢ƒå˜é‡ã€‚</span><br><span class="line"> </span><br><span class="line">                               supervisordå¯åŠ¨å­è¿›ç¨‹æ—¶ï¼Œå­è¿›ç¨‹ä¼šæ‹·è´çˆ¶è¿›ç¨‹çš„å†…å­˜ç©ºé—´å†…å®¹ã€‚ æ‰€ä»¥è®¾ç½®çš„</span><br><span class="line"> </span><br><span class="line">                               è¿™äº›ç¯å¢ƒå˜é‡ä¹Ÿä¼šè¢«å­è¿›ç¨‹ç»§æ‰¿ã€‚</span><br><span class="line"> </span><br><span class="line">                               å°ä¾‹å­ï¼šenvironment=name=<span class="string">&quot;haha&quot;</span>,age=<span class="string">&quot;hehe&quot;</span></span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸ºä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;strip_ansi=<span class="literal">false</span>            ; è¿™ä¸ªé€‰é¡¹å¦‚æœè®¾ç½®ä¸º<span class="literal">true</span>ï¼Œä¼šæ¸…é™¤å­è¿›ç¨‹æ—¥å¿—ä¸­çš„æ‰€æœ‰ANSI åºåˆ—ã€‚ä»€ä¹ˆæ˜¯ANSI</span><br><span class="line"> </span><br><span class="line">                               åºåˆ—å‘¢ï¼Ÿå°±æ˜¯æˆ‘ä»¬çš„\n,\tè¿™äº›ä¸œè¥¿ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">; the below section must remain <span class="keyword">in</span> the config file <span class="keyword">for</span> RPC</span><br><span class="line"> </span><br><span class="line">; (supervisorctl/web interface) to work, additional interfaces may be</span><br><span class="line"> </span><br><span class="line">; added by defining them <span class="keyword">in</span> separate rpcinterface: sections</span><br><span class="line"> </span><br><span class="line">[rpcinterface:supervisor]    ;è¿™ä¸ªé€‰é¡¹æ˜¯ç»™XML_RPCç”¨çš„ï¼Œå½“ç„¶ä½ å¦‚æœæƒ³ä½¿ç”¨supervisordæˆ–è€…web server è¿™ </span><br><span class="line"> </span><br><span class="line">                              ä¸ªé€‰é¡¹å¿…é¡»è¦å¼€å¯çš„</span><br><span class="line"> </span><br><span class="line">supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface </span><br><span class="line"> </span><br><span class="line">[supervisorctl]              ;è¿™ä¸ªä¸»è¦æ˜¯é’ˆå¯¹supervisorctlçš„ä¸€äº›é…ç½®  </span><br><span class="line"> </span><br><span class="line">serverurl=unix:///tmp/supervisor.sock ; è¿™ä¸ªæ˜¯supervisorctlæœ¬åœ°è¿æ¥supervisordçš„æ—¶å€™ï¼Œæœ¬åœ°UNIX socket</span><br><span class="line"> </span><br><span class="line">                                        è·¯å¾„ï¼Œæ³¨æ„è¿™ä¸ªæ˜¯å’Œå‰é¢çš„[unix_http_server]å¯¹åº”çš„</span><br><span class="line"> </span><br><span class="line">                                        é»˜è®¤å€¼å°±æ˜¯unix:///tmp/supervisor.sockã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;serverurl=http://127.0.0.1:9001 ; è¿™ä¸ªæ˜¯supervisorctlè¿œç¨‹è¿æ¥supervisordçš„æ—¶å€™ï¼Œç”¨åˆ°çš„TCP socketè·¯å¾„</span><br><span class="line"> </span><br><span class="line">                                   æ³¨æ„è¿™ä¸ªå’Œå‰é¢çš„[inet_http_server]å¯¹åº”</span><br><span class="line"> </span><br><span class="line">                                   é»˜è®¤å°±æ˜¯http://127.0.0.1:9001ã€‚ã€‚ã€‚éå¿…é¡»é¡¹</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">;username=chris              ; ç”¨æˆ·å</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;password=123                ; å¯†ç </span><br><span class="line"> </span><br><span class="line">                              é»˜è®¤ç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;prompt=mysupervisor         ; è¾“å…¥ç”¨æˆ·åå¯†ç æ—¶å€™çš„æç¤ºç¬¦</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤supervisorã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;history_file=~/.sc_history  ; è¿™ä¸ªå‚æ•°å’Œshellä¸­çš„<span class="built_in">history</span>ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸Šä¸‹é”®æ¥æŸ¥æ‰¾å‰é¢æ‰§è¡Œè¿‡çš„å‘½ä»¤</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æ˜¯no fileçš„ã€‚ã€‚æ‰€ä»¥æˆ‘ä»¬æƒ³è¦æœ‰è¿™ç§åŠŸèƒ½ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ã€‚ã€‚ã€‚é</span><br><span class="line"> </span><br><span class="line">                               å¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">; The below sample program section shows all possible program subsection values,</span><br><span class="line"> </span><br><span class="line">; create one or more <span class="string">&#x27;real&#x27;</span> program: sections to be able to control them under</span><br><span class="line"> </span><br><span class="line">; supervisor.</span><br><span class="line"> </span><br><span class="line">;[program:theprogramname]      ;è¿™ä¸ªå°±æ˜¯å’±ä»¬è¦ç®¡ç†çš„å­è¿›ç¨‹äº†ï¼Œ<span class="string">&quot;:&quot;</span>åé¢çš„æ˜¯åå­—ï¼Œæœ€å¥½åˆ«ä¹±å†™å’Œå®é™…è¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                                æœ‰ç‚¹å…³è”æœ€å¥½ã€‚è¿™æ ·çš„programæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œä¸€ä¸ªprogramå°±æ˜¯</span><br><span class="line"> </span><br><span class="line">                                è¦è¢«ç®¡ç†çš„ä¸€ä¸ªè¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">command</span>=/bin/cat              ; è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„è¦å¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤è·¯å¾„äº†ï¼Œå¯ä»¥å¸¦å‚æ•°</span><br><span class="line"> </span><br><span class="line">                                ä¾‹å­ï¼š/home/test.py -a <span class="string">&#x27;hehe&#x27;</span></span><br><span class="line"> </span><br><span class="line">                                æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çš„<span class="built_in">command</span>åªèƒ½æ˜¯é‚£ç§åœ¨ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹ï¼Œä¸èƒ½æ˜¯</span><br><span class="line"> </span><br><span class="line">                                å®ˆæŠ¤è¿›ç¨‹ã€‚è¿™ä¸ªæƒ³æƒ³ä¹ŸçŸ¥é“äº†ï¼Œæ¯”å¦‚è¯´<span class="built_in">command</span>=service httpd startã€‚</span><br><span class="line"> </span><br><span class="line">                                httpdè¿™ä¸ªè¿›ç¨‹è¢«linuxçš„serviceç®¡ç†äº†ï¼Œæˆ‘ä»¬çš„supervisorå†å»å¯åŠ¨è¿™ä¸ªå‘½ä»¤</span><br><span class="line"> </span><br><span class="line">                                è¿™å·²ç»ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰çš„å­è¿›ç¨‹äº†ã€‚</span><br><span class="line"> </span><br><span class="line">                                è¿™ä¸ªæ˜¯ä¸ªå¿…é¡»è®¾ç½®çš„é¡¹</span><br><span class="line"> </span><br><span class="line">;process_name=%(program_name)s ; è¿™ä¸ªæ˜¯è¿›ç¨‹åï¼Œå¦‚æœæˆ‘ä»¬ä¸‹é¢çš„numprocså‚æ•°ä¸º1çš„è¯ï¼Œå°±ä¸ç”¨ç®¡è¿™ä¸ªå‚æ•°</span><br><span class="line"> </span><br><span class="line">                                 äº†ï¼Œå®ƒé»˜è®¤å€¼%(program_name)sä¹Ÿå°±æ˜¯ä¸Šé¢çš„é‚£ä¸ªprogramå†’å·åé¢çš„åå­—ï¼Œ</span><br><span class="line"> </span><br><span class="line">                                 ä½†æ˜¯å¦‚æœnumprocsä¸ºå¤šä¸ªçš„è¯ï¼Œé‚£å°±ä¸èƒ½è¿™ä¹ˆå¹²äº†ã€‚æƒ³æƒ³ä¹ŸçŸ¥é“ï¼Œä¸å¯èƒ½æ¯ä¸ª</span><br><span class="line"> </span><br><span class="line">                                 è¿›ç¨‹éƒ½ç”¨åŒä¸€ä¸ªè¿›ç¨‹åå§ã€‚</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">;numprocs=1                    ; å¯åŠ¨è¿›ç¨‹çš„æ•°ç›®ã€‚å½“ä¸ä¸º1æ—¶ï¼Œå°±æ˜¯è¿›ç¨‹æ± çš„æ¦‚å¿µï¼Œæ³¨æ„process_nameçš„è®¾ç½®</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º1    ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;directory=/tmp                ; è¿›ç¨‹è¿è¡Œå‰ï¼Œä¼šå‰åˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">umask</span>=022                     ; è¿›ç¨‹æ©ç ï¼Œé»˜è®¤noneï¼Œéå¿…é¡»</span><br><span class="line"> </span><br><span class="line">;priority=999                  ; å­è¿›ç¨‹å¯åŠ¨å…³é—­ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§ä½çš„ï¼Œæœ€å…ˆå¯åŠ¨ï¼Œå…³é—­çš„æ—¶å€™æœ€åå…³é—­</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º999 ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;autostart=<span class="literal">true</span>                ; å¦‚æœæ˜¯<span class="literal">true</span>çš„è¯ï¼Œå­è¿›ç¨‹å°†åœ¨supervisordå¯åŠ¨åè¢«è‡ªåŠ¨å¯åŠ¨</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å°±æ˜¯<span class="literal">true</span>   ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;autorestart=unexpected        ; è¿™ä¸ªæ˜¯è®¾ç½®å­è¿›ç¨‹æŒ‚æ‰åè‡ªåŠ¨é‡å¯çš„æƒ…å†µï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹ï¼Œ<span class="literal">false</span>,unexpected</span><br><span class="line"> </span><br><span class="line">                                 å’Œ<span class="literal">true</span>ã€‚å¦‚æœä¸º<span class="literal">false</span>çš„æ—¶å€™ï¼Œæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½ä¸ä¼šè¢«é‡æ–°å¯åŠ¨ï¼Œ</span><br><span class="line"> </span><br><span class="line">                                 å¦‚æœä¸ºunexpectedï¼Œåªæœ‰å½“è¿›ç¨‹çš„é€€å‡ºç ä¸åœ¨ä¸‹é¢çš„exitcodesé‡Œé¢å®šä¹‰çš„é€€ </span><br><span class="line"> </span><br><span class="line">                                 å‡ºç çš„æ—¶å€™ï¼Œæ‰ä¼šè¢«è‡ªåŠ¨é‡å¯ã€‚å½“ä¸º<span class="literal">true</span>çš„æ—¶å€™ï¼Œåªè¦å­è¿›ç¨‹æŒ‚æ‰ï¼Œå°†ä¼šè¢«æ— </span><br><span class="line"> </span><br><span class="line">                                 æ¡ä»¶çš„é‡å¯</span><br><span class="line"> </span><br><span class="line">;startsecs=1                   ; è¿™ä¸ªé€‰é¡¹æ˜¯å­è¿›ç¨‹å¯åŠ¨å¤šå°‘ç§’ä¹‹åï¼Œæ­¤æ—¶çŠ¶æ€å¦‚æœæ˜¯runningï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºå¯</span><br><span class="line"> </span><br><span class="line">                                 åŠ¨æˆåŠŸäº†</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º1 ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;startretries=3                ; å½“è¿›ç¨‹å¯åŠ¨å¤±è´¥åï¼Œæœ€å¤§å°è¯•å¯åŠ¨çš„æ¬¡æ•°ã€‚ã€‚å½“è¶…è¿‡3æ¬¡åï¼Œsupervisorå°†æŠŠ</span><br><span class="line"> </span><br><span class="line">                                 æ­¤è¿›ç¨‹çš„çŠ¶æ€ç½®ä¸ºFAIL</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º3 ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;exitcodes=0,2                 ; æ³¨æ„å’Œä¸Šé¢çš„çš„autorestart=unexpectedå¯¹åº”ã€‚ã€‚exitcodesé‡Œé¢çš„å®šä¹‰çš„</span><br><span class="line"> </span><br><span class="line">                                 é€€å‡ºç æ˜¯expectedçš„ã€‚</span><br><span class="line"> </span><br><span class="line">;stopsignal=QUIT               ; è¿›ç¨‹åœæ­¢ä¿¡å·ï¼Œå¯ä»¥ä¸ºTERM, HUP, INT, QUIT, KILL, USR1, or USR2ç­‰ä¿¡å·</span><br><span class="line"> </span><br><span class="line">                                  é»˜è®¤ä¸ºTERM ã€‚ã€‚å½“ç”¨è®¾å®šçš„ä¿¡å·å»å¹²æ‰è¿›ç¨‹ï¼Œé€€å‡ºç ä¼šè¢«è®¤ä¸ºæ˜¯expected</span><br><span class="line"> </span><br><span class="line">                                  éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stopwaitsecs=10               ; è¿™ä¸ªæ˜¯å½“æˆ‘ä»¬å‘å­è¿›ç¨‹å‘é€stopsignalä¿¡å·åï¼Œåˆ°ç³»ç»Ÿè¿”å›ä¿¡æ¯</span><br><span class="line"> </span><br><span class="line">                                 ç»™supervisordï¼Œæ‰€ç­‰å¾…çš„æœ€å¤§æ—¶é—´ã€‚ è¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œsupervisordä¼šå‘è¯¥</span><br><span class="line"> </span><br><span class="line">                                 å­è¿›ç¨‹å‘é€ä¸€ä¸ªå¼ºåˆ¶<span class="built_in">kill</span>çš„ä¿¡å·ã€‚</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º10ç§’ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stopasgroup=<span class="literal">false</span>             ; è¿™ä¸ªä¸œè¥¿ä¸»è¦ç”¨äºï¼Œsupervisordç®¡ç†çš„å­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹æœ¬èº«è¿˜æœ‰</span><br><span class="line"> </span><br><span class="line">                                 å­è¿›ç¨‹ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚æœä»…ä»…å¹²æ‰supervisordçš„å­è¿›ç¨‹çš„è¯ï¼Œå­è¿›ç¨‹çš„å­è¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                                 æœ‰å¯èƒ½ä¼šå˜æˆå­¤å„¿è¿›ç¨‹ã€‚æ‰€ä»¥å’±ä»¬å¯ä»¥è®¾ç½®å¯ä¸ªé€‰é¡¹ï¼ŒæŠŠæ•´ä¸ªè¯¥å­è¿›ç¨‹çš„</span><br><span class="line"> </span><br><span class="line">                                 æ•´ä¸ªè¿›ç¨‹ç»„éƒ½å¹²æ‰ã€‚ è®¾ç½®ä¸º<span class="literal">true</span>çš„è¯ï¼Œä¸€èˆ¬killasgroupä¹Ÿä¼šè¢«è®¾ç½®ä¸º<span class="literal">true</span>ã€‚</span><br><span class="line"> </span><br><span class="line">                                 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥é€‰é¡¹å‘é€çš„æ˜¯stopä¿¡å·</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚éå¿…é¡»è®¾ç½®ã€‚ã€‚</span><br><span class="line"> </span><br><span class="line">;killasgroup=<span class="literal">false</span>             ; è¿™ä¸ªå’Œä¸Šé¢çš„stopasgroupç±»ä¼¼ï¼Œä¸è¿‡å‘é€çš„æ˜¯<span class="built_in">kill</span>ä¿¡å·</span><br><span class="line"> </span><br><span class="line">;user=chrism                   ; å¦‚æœsupervisordæ˜¯rootå¯åŠ¨ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®è¿™ä¸ªérootç”¨æˆ·ï¼Œå¯ä»¥ç”¨æ¥</span><br><span class="line"> </span><br><span class="line">                                 ç®¡ç†è¯¥program</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;redirect_stderr=<span class="literal">true</span>          ; å¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™stderrçš„æ—¥å¿—ä¼šè¢«å†™å…¥stdoutæ—¥å¿—æ–‡ä»¶ä¸­</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º<span class="literal">false</span>ï¼Œéå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stdout_logfile=/a/path        ; å­è¿›ç¨‹çš„stdoutçš„æ—¥å¿—è·¯å¾„ï¼Œå¯ä»¥æŒ‡å®šè·¯å¾„ï¼ŒAUTOï¼Œnoneç­‰ä¸‰ä¸ªé€‰é¡¹ã€‚</span><br><span class="line"> </span><br><span class="line">                                 è®¾ç½®ä¸ºnoneçš„è¯ï¼Œå°†æ²¡æœ‰æ—¥å¿—äº§ç”Ÿã€‚è®¾ç½®ä¸ºAUTOçš„è¯ï¼Œå°†éšæœºæ‰¾ä¸€ä¸ªåœ°æ–¹</span><br><span class="line"> </span><br><span class="line">                                 ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸”å½“supervisordé‡æ–°å¯åŠ¨çš„æ—¶å€™ï¼Œä»¥å‰çš„æ—¥å¿—æ–‡ä»¶ä¼šè¢«</span><br><span class="line"> </span><br><span class="line">                                 æ¸…ç©ºã€‚å½“ redirect_stderr=<span class="literal">true</span>çš„æ—¶å€™ï¼Œsterrä¹Ÿä¼šå†™è¿›è¿™ä¸ªæ—¥å¿—æ–‡ä»¶</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_maxbytes=1MB   ; æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œå’Œ[supervisord]ä¸­å®šä¹‰çš„ä¸€æ ·ã€‚é»˜è®¤ä¸º50</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_backups=10     ; å’Œ[supervisord]å®šä¹‰çš„ä¸€æ ·ã€‚é»˜è®¤10</span><br><span class="line"> </span><br><span class="line">;stdout_capture_maxbytes=1MB   ; è¿™ä¸ªä¸œè¥¿æ˜¯è®¾å®šcaptureç®¡é“çš„å¤§å°ï¼Œå½“å€¼ä¸ä¸º0çš„æ—¶å€™ï¼Œå­è¿›ç¨‹å¯ä»¥ä»stdout</span><br><span class="line"> </span><br><span class="line">                                 å‘é€ä¿¡æ¯ï¼Œè€Œsupervisorå¯ä»¥æ ¹æ®ä¿¡æ¯ï¼Œå‘é€ç›¸åº”çš„eventã€‚</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º0ï¼Œä¸º0çš„æ—¶å€™è¡¨è¾¾å…³é—­ç®¡é“ã€‚ã€‚ã€‚éå¿…é¡»é¡¹</span><br><span class="line"> </span><br><span class="line">;stdout_events_enabled=<span class="literal">false</span>   ; å½“è®¾ç½®ä¸ºtureçš„æ—¶å€™ï¼Œå½“å­è¿›ç¨‹ç”±stdoutå‘æ–‡ä»¶æè¿°ç¬¦ä¸­å†™æ—¥å¿—çš„æ—¶å€™ï¼Œå°†</span><br><span class="line"> </span><br><span class="line">                                 è§¦å‘supervisordå‘é€PROCESS_LOG_STDOUTç±»å‹çš„event</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stderr_logfile=/a/path        ; è¿™ä¸ªä¸œè¥¿æ˜¯è®¾ç½®stderrå†™çš„æ—¥å¿—è·¯å¾„ï¼Œå½“redirect_stderr=<span class="literal">true</span>ã€‚è¿™ä¸ªå°±ä¸ç”¨</span><br><span class="line"> </span><br><span class="line">                                 è®¾ç½®äº†ï¼Œè®¾ç½®äº†ä¹Ÿæ˜¯ç™½æ­ã€‚å› ä¸ºå®ƒä¼šè¢«å†™å…¥stdout_logfileçš„åŒä¸€ä¸ªæ–‡ä»¶ä¸­</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸ºAUTOï¼Œä¹Ÿå°±æ˜¯éšä¾¿æ‰¾ä¸ªåœ°å­˜ï¼Œsupervisordé‡å¯è¢«æ¸…ç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_maxbytes=1MB   ; è¿™ä¸ªå‡ºç°å¥½å‡ æ¬¡äº†ï¼Œå°±ä¸é‡å¤äº†</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_backups=10     ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stderr_capture_maxbytes=1MB   ; è¿™ä¸ªä¸€æ ·ï¼Œå’Œstdout_captureä¸€æ ·ã€‚ é»˜è®¤ä¸º0ï¼Œå…³é—­çŠ¶æ€</span><br><span class="line"> </span><br><span class="line">;stderr_events_enabled=<span class="literal">false</span>   ; è¿™ä¸ªä¹Ÿæ˜¯ä¸€æ ·ï¼Œé»˜è®¤ä¸º<span class="literal">false</span></span><br><span class="line"> </span><br><span class="line">;environment=A=<span class="string">&quot;1&quot;</span>,B=<span class="string">&quot;2&quot;</span>       ; è¿™ä¸ªæ˜¯è¯¥å­è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œå’Œåˆ«çš„å­è¿›ç¨‹æ˜¯ä¸å…±äº«çš„</span><br><span class="line"> </span><br><span class="line">;serverurl=AUTO                ; </span><br><span class="line"> </span><br><span class="line">; The below sample eventlistener section shows all possible</span><br><span class="line"> </span><br><span class="line">; eventlistener subsection values, create one or more <span class="string">&#x27;real&#x27;</span></span><br><span class="line"> </span><br><span class="line">; eventlistener: sections to be able to handle event notifications</span><br><span class="line"> </span><br><span class="line">; sent by supervisor.</span><br><span class="line"> </span><br><span class="line">;[eventlistener:theeventlistenername] ;è¿™ä¸ªä¸œè¥¿å…¶å®å’Œprogramçš„åœ°ä½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯suopervisorå¯åŠ¨çš„å­è¿›</span><br><span class="line"> </span><br><span class="line">                                       ç¨‹ï¼Œä¸è¿‡å®ƒå¹²çš„æ´»æ˜¯è®¢é˜…supervisordå‘é€çš„eventã€‚ä»–çš„åå­—å°±å«</span><br><span class="line"> </span><br><span class="line">                                       listeneräº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨listeneré‡Œé¢åšä¸€ç³»åˆ—å¤„ç†ï¼Œæ¯”å¦‚æŠ¥è­¦ç­‰ç­‰</span><br><span class="line"> </span><br><span class="line">                                       æ¥¼ä¸»è¿™ä¸¤å¤©å¹²çš„æ´»ï¼Œå°±æ˜¯å¼„çš„è¿™ç©æ„</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">command</span>=/bin/eventlistener    ; è¿™ä¸ªå’Œä¸Šé¢çš„programä¸€æ ·ï¼Œè¡¨ç¤ºlistenerçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</span><br><span class="line"> </span><br><span class="line">;process_name=%(program_name)s ; è¿™ä¸ªä¹Ÿä¸€æ ·ï¼Œè¿›ç¨‹åï¼Œå½“ä¸‹é¢çš„numprocsä¸ºå¤šä¸ªçš„æ—¶å€™ï¼Œæ‰éœ€è¦ã€‚å¦åˆ™é»˜è®¤å°±</span><br><span class="line"> </span><br><span class="line">                                 OKäº†</span><br><span class="line"> </span><br><span class="line">;numprocs=1                    ; ç›¸åŒçš„listenerå¯åŠ¨çš„ä¸ªæ•°</span><br><span class="line"> </span><br><span class="line">;events=EVENT                  ; eventäº‹ä»¶çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å†™åœ¨è¿™ä¸ªåœ°æ–¹çš„äº‹ä»¶ç±»å‹ã€‚æ‰ä¼šè¢«å‘é€</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">;buffer_size=10                ; è¿™ä¸ªæ˜¯eventé˜Ÿåˆ—ç¼“å­˜å¤§å°ï¼Œå•ä½ä¸å¤ªæ¸…æ¥šï¼Œæ¥¼ä¸»çŒœæµ‹åº”è¯¥æ˜¯ä¸ªå§ã€‚å½“buffer</span><br><span class="line"> </span><br><span class="line">                                 è¶…è¿‡10çš„æ—¶å€™ï¼Œæœ€æ—§çš„eventå°†ä¼šè¢«æ¸…é™¤ï¼Œå¹¶æŠŠæ–°çš„eventæ”¾è¿›å»ã€‚</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º10ã€‚ã€‚éå¿…é¡»é€‰é¡¹</span><br><span class="line"> </span><br><span class="line">;directory=/tmp                ; è¿›ç¨‹æ‰§è¡Œå‰ï¼Œä¼šåˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œ</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸ºä¸åˆ‡æ¢ã€‚ã€‚ã€‚éå¿…é¡»</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">umask</span>=022                     ; æ·¹æ²¡ï¼Œé»˜è®¤ä¸ºnoneï¼Œä¸è¯´äº†</span><br><span class="line"> </span><br><span class="line">;priority=-1                   ; å¯åŠ¨ä¼˜å…ˆçº§ï¼Œé»˜è®¤-1ï¼Œä¹Ÿä¸æ‰¯äº†</span><br><span class="line"> </span><br><span class="line">;autostart=<span class="literal">true</span>                ; æ˜¯å¦éšsupervisordå¯åŠ¨ä¸€èµ·å¯åŠ¨ï¼Œé»˜è®¤<span class="literal">true</span></span><br><span class="line"> </span><br><span class="line">;autorestart=unexpected        ; æ˜¯å¦è‡ªåŠ¨é‡å¯ï¼Œå’Œprogramä¸€ä¸ªæ ·ï¼Œåˆ†<span class="literal">true</span>,<span class="literal">false</span>,unexpectedç­‰ï¼Œæ³¨æ„</span><br><span class="line"> </span><br><span class="line">                                  unexpectedå’Œexitcodesçš„å…³ç³»</span><br><span class="line"> </span><br><span class="line">;startsecs=1                   ; ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¿›ç¨‹å¯åŠ¨åè·‘äº†å‡ ç§’é’Ÿï¼Œæ‰è¢«è®¤å®šä¸ºæˆåŠŸå¯åŠ¨ï¼Œé»˜è®¤1</span><br><span class="line"> </span><br><span class="line">;startretries=3                ; å¤±è´¥æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œé»˜è®¤3</span><br><span class="line"> </span><br><span class="line">;exitcodes=0,2                 ; æœŸæœ›æˆ–è€…è¯´é¢„æ–™ä¸­çš„è¿›ç¨‹é€€å‡ºç ï¼Œ</span><br><span class="line"> </span><br><span class="line">;stopsignal=QUIT               ; å¹²æ‰è¿›ç¨‹çš„ä¿¡å·ï¼Œé»˜è®¤ä¸ºTERMï¼Œæ¯”å¦‚è®¾ç½®ä¸ºQUITï¼Œé‚£ä¹ˆå¦‚æœQUITæ¥å¹²è¿™ä¸ªè¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                                 é‚£ä¹ˆä¼šè¢«è®¤ä¸ºæ˜¯æ­£å¸¸ç»´æŠ¤ï¼Œé€€å‡ºç ä¹Ÿè¢«è®¤ä¸ºæ˜¯expectedä¸­çš„</span><br><span class="line"> </span><br><span class="line">;stopwaitsecs=10               ; max num secs to <span class="built_in">wait</span> b4 SIGKILL (default 10)</span><br><span class="line"> </span><br><span class="line">;stopasgroup=<span class="literal">false</span>             ; send stop signal to the UNIX process group (default <span class="literal">false</span>)</span><br><span class="line"> </span><br><span class="line">;killasgroup=<span class="literal">false</span>             ; SIGKILL the UNIX process group (def <span class="literal">false</span>)</span><br><span class="line"> </span><br><span class="line">;user=chrism                   ;è®¾ç½®æ™®é€šç”¨æˆ·ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç†è¯¥listenerè¿›ç¨‹ã€‚</span><br><span class="line"> </span><br><span class="line">                                é»˜è®¤ä¸ºç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;redirect_stderr=<span class="literal">true</span>          ; ä¸º<span class="literal">true</span>çš„è¯ï¼Œstderrçš„<span class="built_in">log</span>ä¼šå¹¶å…¥stdoutçš„<span class="built_in">log</span>é‡Œé¢</span><br><span class="line"> </span><br><span class="line">                                é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stdout_logfile=/a/path        ; è¿™ä¸ªä¸è¯´äº†ï¼Œå¥½å‡ éäº†</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_maxbytes=1MB   ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_backups=10     ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stdout_events_enabled=<span class="literal">false</span>   ; è¿™ä¸ªå…¶å®æ˜¯é”™çš„ï¼Œlisteneræ˜¯ä¸èƒ½å‘é€event</span><br><span class="line"> </span><br><span class="line">;stderr_logfile=/a/path        ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_maxbytes=1MB   ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_backups        ; è¿™ä¸ªä¸è¯´äº†</span><br><span class="line"> </span><br><span class="line">;stderr_events_enabled=<span class="literal">false</span>   ; è¿™ä¸ªä¹Ÿæ˜¯é”™çš„ï¼Œlistenerä¸èƒ½å‘é€event</span><br><span class="line"> </span><br><span class="line">;environment=A=<span class="string">&quot;1&quot;</span>,B=<span class="string">&quot;2&quot;</span>       ; è¿™ä¸ªæ˜¯è¯¥å­è¿›ç¨‹çš„ç¯å¢ƒå˜é‡</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸ºç©ºã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;serverurl=AUTO                ; override serverurl computation (childutils)</span><br><span class="line"> </span><br><span class="line">; The below sample group section shows all possible group values,</span><br><span class="line"> </span><br><span class="line">; create one or more <span class="string">&#x27;real&#x27;</span> group: sections to create <span class="string">&quot;heterogeneous&quot;</span></span><br><span class="line"> </span><br><span class="line">; process <span class="built_in">groups</span>.</span><br><span class="line"> </span><br><span class="line">;[group:thegroupname]  ;è¿™ä¸ªä¸œè¥¿å°±æ˜¯ç»™programsåˆ†ç»„ï¼Œåˆ’åˆ†åˆ°ç»„é‡Œé¢çš„programã€‚æˆ‘ä»¬å°±ä¸ç”¨ä¸€ä¸ªä¸€ä¸ªå»æ“ä½œäº†</span><br><span class="line"> </span><br><span class="line">                         æˆ‘ä»¬å¯ä»¥å¯¹ç»„åè¿›è¡Œç»Ÿä¸€çš„æ“ä½œã€‚ æ³¨æ„ï¼šprogramè¢«åˆ’åˆ†åˆ°ç»„é‡Œé¢ä¹‹åï¼Œå°±ç›¸å½“äºåŸæ¥</span><br><span class="line"> </span><br><span class="line">                         çš„é…ç½®ä»supervisorçš„é…ç½®æ–‡ä»¶é‡Œæ¶ˆå¤±äº†ã€‚ã€‚ã€‚supervisoråªä¼šå¯¹ç»„è¿›è¡Œç®¡ç†ï¼Œè€Œä¸å†</span><br><span class="line"> </span><br><span class="line">                         ä¼šå¯¹ç»„é‡Œé¢çš„å•ä¸ªprogramè¿›è¡Œç®¡ç†äº†</span><br><span class="line"> </span><br><span class="line">;programs=progname1,progname2  ; ç»„æˆå‘˜ï¼Œç”¨é€—å·åˆ†å¼€</span><br><span class="line"> </span><br><span class="line">                                 è¿™ä¸ªæ˜¯ä¸ªå¿…é¡»çš„è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;priority=999                  ; ä¼˜å…ˆçº§ï¼Œç›¸å¯¹äºç»„å’Œç»„ä¹‹é—´è¯´çš„</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤999ã€‚ã€‚éå¿…é¡»é€‰é¡¹</span><br><span class="line"> </span><br><span class="line">; The [include] section can just contain the <span class="string">&quot;files&quot;</span> setting.  This</span><br><span class="line"> </span><br><span class="line">; setting can list multiple files (separated by whitespace or</span><br><span class="line"> </span><br><span class="line">; newlines).  It can also contain wildcards.  The filenames are</span><br><span class="line"> </span><br><span class="line">; interpreted as relative to this file.  Included files *cannot*</span><br><span class="line"> </span><br><span class="line">; include files themselves.</span><br><span class="line"> </span><br><span class="line">;[include]                         ;è¿™ä¸ªä¸œè¥¿æŒºæœ‰ç”¨çš„ï¼Œå½“æˆ‘ä»¬è¦ç®¡ç†çš„è¿›ç¨‹å¾ˆå¤šçš„æ—¶å€™ï¼Œå†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢</span><br><span class="line"> </span><br><span class="line">                                    å°±æœ‰ç‚¹å¤§äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠé…ç½®ä¿¡æ¯å†™åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åincludeè¿‡æ¥</span><br><span class="line"> </span><br><span class="line">;files = relative/directory/*.ini</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Supervisoræ§åˆ¶å°">Supervisoræ§åˆ¶å°</h2>
<ul>
<li>åœ¨/etc/supervisord.confä¸­ä¿®æ”¹[inet_http_server]çš„å‚æ•°ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[inet_http_server]         ; inet (TCP) server disabled by default</span><br><span class="line">port=*:9001                ; ip_address:port specifier, *:port for all iface</span><br><span class="line">username=root              ; default is no username (open server)</span><br><span class="line">password=xxxx              ; default is no password (open server)</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¿®æ”¹åé‡å¯supervisorè¿›ç¨‹ï¼Œåœ¨æµè§ˆå™¨è®¿é—® <code>http://&lt;host-ip&gt;:9001</code></li>
</ul>
<h2 id="åˆ†ç»„ç®¡ç†">åˆ†ç»„ç®¡ç†</h2>
<ul>
<li>Supervisor åŒæ—¶è¿˜æä¾›äº†å¦å¤–ä¸€ç§è¿›ç¨‹ç»„çš„ç®¡ç†æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ supervisorctl å‘½ä»¤æ¥ç®¡ç†ä¸€ç»„è¿›ç¨‹ï¼Œé€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼Œå°†å¤šä¸ªæœåŠ¡æ·»åŠ è‡³åˆ†ç»„ä¸­</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[group:group_name]</span><br><span class="line">programs=progname1,progname2</span><br></pre></td></tr></table></figure>
<ul>
<li>æ³¨æ„:
<ul>
<li>å½“æ·»åŠ äº†ä¸Šè¿°é…ç½®åï¼Œprogname1 å’Œ progname2 çš„è¿›ç¨‹åå°±ä¼šå˜æˆ group_name:progname1 å’Œ group_name:progname2 ä»¥åå°±è¦ç”¨è¿™ä¸ªåå­—æ¥ç®¡ç†è¿›ç¨‹äº†ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„ progname1ã€‚</li>
<li>ä»¥åæ‰§è¡Œ supervisorctl stop group_name: å°±èƒ½åŒæ—¶ç»“æŸ progname1 å’Œ progname2ï¼Œæ‰§è¡Œ supervisorctl stop group_name:progname1 å°±èƒ½ç»“æŸ progname1</li>
</ul>
</li>
</ul>
<h2 id="Supervisoré…ç½®å¼€æœºå¯åŠ¨">Supervisoré…ç½®å¼€æœºå¯åŠ¨</h2>
<h3 id="æ–¹å¼ä¸€ï¼š">æ–¹å¼ä¸€ï¼š</h3>
<ul>
<li>Linuxç¯å¢ƒä¸­ï¼šä»¥systemdçš„æ–¹å¼ç®¡ç†
<ul>
<li>ç¼–å†™å¯åŠ¨è„šæœ¬ï¼švim /etc/rc.d/init.d/supervisord</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/rc.d/init.d/supervisord</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Supervisor is a client/server system that</span></span><br><span class="line"><span class="comment"># allows its users to monitor and control a</span></span><br><span class="line"><span class="comment"># number of processes on UNIX-like operating</span></span><br><span class="line"><span class="comment"># systems.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chkconfig: - 64 36</span></span><br><span class="line"><span class="comment"># description: Supervisor Server</span></span><br><span class="line"><span class="comment"># processname: supervisord</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Source init functions</span></span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"></span><br><span class="line">prog=<span class="string">&quot;supervisord&quot;</span></span><br><span class="line"></span><br><span class="line">prefix=<span class="string">&quot;/usr&quot;</span></span><br><span class="line">exec_prefix=<span class="string">&quot;<span class="variable">$&#123;prefix&#125;</span>&quot;</span></span><br><span class="line">prog_bin=<span class="string">&quot;<span class="variable">$&#123;exec_prefix&#125;</span>/bin/supervisord&quot;</span></span><br><span class="line">PIDFILE=<span class="string">&quot;/var/run/<span class="variable">$prog</span>.pid&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">start</span></span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> -n $<span class="string">&quot;Starting <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">daemon <span class="variable">$prog_bin</span> --pidfile <span class="variable">$PIDFILE</span> -c /etc/supervisord.conf</span><br><span class="line">[ -f <span class="variable">$PIDFILE</span> ] &amp;&amp; success $<span class="string">&quot;<span class="variable">$prog</span> startup&quot;</span> || failure $<span class="string">&quot;<span class="variable">$prog</span> startup&quot;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">stop</span></span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> -n $<span class="string">&quot;Shutting down <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">[ -f <span class="variable">$PIDFILE</span> ] &amp;&amp; killproc <span class="variable">$prog</span> || success $<span class="string">&quot;<span class="variable">$prog</span> shutdown&quot;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">start)</span><br><span class="line">start</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">stop)</span><br><span class="line">stop</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">status)</span><br><span class="line">status <span class="variable">$prog</span></span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">restart)</span><br><span class="line">stop</span><br><span class="line">start</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> &#123;start|stop|restart|status&#125;&quot;</span></span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è®¾ç½®å¼€æœºå¯åŠ¨åŠsystemdæ–¹å¼å¯åŠ¨ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> +x /etc/rc.d/init.d/supervisord</span><br><span class="line"><span class="built_in">sudo</span> chkconfig --add supervisord</span><br><span class="line"><span class="built_in">sudo</span> chkconfig supervisord on</span><br><span class="line"><span class="built_in">sudo</span> service supervisord start</span><br></pre></td></tr></table></figure>
<h3 id="æ–¹å¼äºŒï¼š">æ–¹å¼äºŒï¼š</h3>
<blockquote>
<p>centos-7</p>
</blockquote>
<ul>
<li>è¿›å…¥ / lib/systemd/system ç›®å½•ï¼Œå¹¶åˆ›å»º supervisord.service æ–‡ä»¶ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=supervisord</span><br><span class="line">After=network.target</span><br><span class="line"> </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/bin/supervisord -c /etc/supervisor/supervisord.conf</span><br><span class="line">ExecStop=/usr/bin/supervisorctl <span class="variable">$OPTIONS</span> shutdown</span><br><span class="line">ExecReload=/usr/bin/supervisorctl <span class="variable">$OPTIONS</span> reload</span><br><span class="line">KillMode=process</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=42s</span><br><span class="line"> </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>
<ul>
<li>åŠ å…¥å¼€æœºå¯åŠ¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 766 /lib/systemd/system/supervisord.service</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl <span class="built_in">enable</span> supervisord.service</span><br><span class="line">systemctl start supervisord</span><br><span class="line">systemctl status supervisord</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®æ¡ˆä¾‹">é…ç½®æ¡ˆä¾‹:</h2>
<h3 id="Djangoçš„é…ç½®æ–‡ä»¶">Djangoçš„é…ç½®æ–‡ä»¶</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#é¡¹ç›®å</span><br><span class="line">[program:django]</span><br><span class="line">#è„šæœ¬ç›®å½•</span><br><span class="line">directory=/root/social_engineering/</span><br><span class="line">#è„šæœ¬æ‰§è¡Œå‘½ä»¤</span><br><span class="line">command=/root/anaconda3/bin/python manage.py runserver 0.0.0.0:8000</span><br><span class="line"></span><br><span class="line">#supervisorå¯åŠ¨çš„æ—¶å€™æ˜¯å¦éšç€åŒæ—¶å¯åŠ¨ï¼Œé»˜è®¤True</span><br><span class="line">autostart=true</span><br><span class="line">#å½“ç¨‹åºexitçš„æ—¶å€™ï¼Œè¿™ä¸ªprogramä¸ä¼šè‡ªåŠ¨é‡å¯,é»˜è®¤unexpectedï¼Œè®¾ç½®å­è¿›ç¨‹æŒ‚æ‰åè‡ªåŠ¨é‡å¯çš„æƒ…å†µï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹ï¼Œfalse,unexpectedå’Œtrueã€‚å¦‚æœä¸ºfalseçš„æ—¶å€™ï¼Œæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½ä¸ä¼šè¢«é‡æ–°å¯åŠ¨ï¼Œå¦‚æœä¸ºunexpectedï¼Œåªæœ‰å½“è¿›ç¨‹çš„</span><br><span class="line">é€€å‡ºç ä¸åœ¨ä¸‹é¢çš„exitcodesé‡Œé¢å®šä¹‰çš„</span><br><span class="line">autorestart=true</span><br><span class="line">#è¿™ä¸ªé€‰é¡¹æ˜¯å­è¿›ç¨‹å¯åŠ¨å¤šå°‘ç§’ä¹‹åï¼Œæ­¤æ—¶çŠ¶æ€å¦‚æœæ˜¯runningï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºå¯åŠ¨æˆåŠŸäº†ã€‚é»˜è®¤å€¼ä¸º1</span><br><span class="line">startsecs=1</span><br><span class="line"></span><br><span class="line">#è„šæœ¬è¿è¡Œçš„ç”¨æˆ·èº«ä»½ </span><br><span class="line"></span><br><span class="line">#æ—¥å¿—è¾“å‡º </span><br><span class="line">stderr_logfile=/tmp/django_stderr.log</span><br><span class="line">stdout_logfile=/tmp/django_stdout.log</span><br><span class="line">#æŠŠstderré‡å®šå‘åˆ°stdoutï¼Œé»˜è®¤ false</span><br><span class="line">redirect_stderr = true</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MB</span><br><span class="line">stdout_logfile_maxbytes = 20</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°</span><br><span class="line">stdout_logfile_backups = 20</span><br><span class="line"></span><br><span class="line">; å¯ä»¥é€šè¿‡ environment æ¥æ·»åŠ éœ€è¦çš„ç¯å¢ƒå˜é‡ï¼Œä¸€ç§å¸¸è§çš„ç”¨æ³•æ˜¯ä¿®æ”¹ PYTHONPATH</span><br><span class="line">; environment=PYTHONPATH=$PYTHONPATH:/path/to/somewhere</span><br></pre></td></tr></table></figure>
<h3 id="Celeryçš„é…ç½®æ–‡ä»¶">Celeryçš„é…ç½®æ–‡ä»¶</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#é¡¹ç›®å</span><br><span class="line">[program:celery]</span><br><span class="line">#è„šæœ¬ç›®å½•</span><br><span class="line">directory=/root/social_engineering/</span><br><span class="line">#è„šæœ¬æ‰§è¡Œå‘½ä»¤</span><br><span class="line">command=/root/anaconda3/bin/celery -A tasks worker --loglevel=info</span><br><span class="line"></span><br><span class="line">#supervisorå¯åŠ¨çš„æ—¶å€™æ˜¯å¦éšç€åŒæ—¶å¯åŠ¨ï¼Œé»˜è®¤True</span><br><span class="line">autostart=true</span><br><span class="line">#ç¨‹åºå´©æºƒæ—¶è‡ªåŠ¨é‡å¯</span><br><span class="line">autorestart=true</span><br><span class="line">#è¿™ä¸ªé€‰é¡¹æ˜¯å­è¿›ç¨‹å¯åŠ¨å¤šå°‘ç§’ä¹‹åï¼Œæ­¤æ—¶çŠ¶æ€å¦‚æœæ˜¯runningï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºå¯åŠ¨æˆåŠŸäº†ã€‚é»˜è®¤å€¼ä¸º1</span><br><span class="line">startsecs=1</span><br><span class="line"></span><br><span class="line">#è„šæœ¬è¿è¡Œçš„ç”¨æˆ·èº«ä»½ </span><br><span class="line"></span><br><span class="line">#æ—¥å¿—è¾“å‡º </span><br><span class="line">stderr_logfile=/tmp/celery_stderr.log</span><br><span class="line">stdout_logfile=/tmp/celery_stdout.log</span><br><span class="line">#æŠŠstderré‡å®šå‘åˆ°stdoutï¼Œé»˜è®¤ false</span><br><span class="line">redirect_stderr = true</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MB</span><br><span class="line">stdout_logfile_maxbytes = 20</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°</span><br><span class="line">stdout_logfile_backups = 20</span><br></pre></td></tr></table></figure>
<h3 id="Redisçš„é…ç½®æ–‡ä»¶">Redisçš„é…ç½®æ–‡ä»¶</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[program:zedis]</span><br><span class="line"><span class="built_in">command</span>=/opt/zedis/redis-server /opt/zedis/redis.conf</span><br><span class="line">user=redisuser</span><br><span class="line">autostart=<span class="literal">true</span> 								</span><br><span class="line">;å¯åŠ¨supervisordçš„æ—¶å€™ä¼šå°†è¯¥é…ç½®é¡¹è®¾ç½®ä¸º<span class="literal">true</span>çš„æ‰€æœ‰è¿›ç¨‹è‡ªåŠ¨å¯åŠ¨</span><br><span class="line">stopasgroup=<span class="literal">true</span>							</span><br><span class="line">;ä½¿ç”¨supervisorctlåœæ­¢zedisæ—¶ï¼Œå­è¿›ç¨‹ä¹Ÿä¼šä¸€èµ·åœæ­¢</span><br><span class="line">killasgroup=<span class="literal">true</span>							</span><br><span class="line">;å‘è¿›ç¨‹ç»„å‘é€<span class="built_in">kill</span>ä¿¡å·ï¼ŒåŒ…æ‹¬å­è¿›ç¨‹</span><br><span class="line">startsecs=10								</span><br><span class="line">;è¿›ç¨‹ä»STARINGçŠ¶æ€è½¬æ¢åˆ°RUNNINGçŠ¶æ€æ‰€éœ€è¦ä¿æŒè¿è¡Œ10sæ—¶é—´</span><br><span class="line">startretries=3								</span><br><span class="line">;å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯3</span><br><span class="line">autorestart=<span class="literal">true</span>							</span><br><span class="line">;è¿›ç¨‹åœæ­¢åè‡ªåŠ¨å¯åŠ¨</span><br><span class="line">stdout_logfile=/var/log/zedis-out</span><br><span class="line">stdout_logfile_maxbytes=1MB</span><br><span class="line">stdout_logfile_backups=10</span><br><span class="line">stderr_logfile=/var/log/zedis-err</span><br><span class="line">stderr_logfile_maxbytes=1MB</span><br><span class="line">stderr_logfile_backups=10</span><br></pre></td></tr></table></figure>
<ul>
<li>Ã˜ å› ä¸ºæ— æ³•ç›‘è§†åå°è¿›ç¨‹ï¼Œéœ€è¦æŠŠZediså‰å°è¿è¡Œï¼ˆdaemonize noï¼‰ï¼Œå¦åˆ™ä¼šè¯†åˆ«ä¸åˆ°Zediså¯åŠ¨ï¼Œé‡è¯•å¯åŠ¨3æ¬¡,æ—¥å¿—æç¤º6379å·²å ç”¨ã€‚</li>
<li>Ã˜ å› ä¸ºredis.confæŒ‡å®šäº†logfileï¼Œstdout_logfileå¹¶æ— å†…å®¹è¾“å‡ºï¼›å¦‚æœä¸æŒ‡å®šredis.confåªæ˜¯å¯åŠ¨redis-serverï¼Œæ—¥å¿—ä¼šè¾“å‡ºåˆ°stdout_logfileã€‚</li>
</ul>
<h3 id="tomcatçš„é…ç½®æ–‡ä»¶">tomcatçš„é…ç½®æ–‡ä»¶</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[program:tomcat]</span><br><span class="line"><span class="built_in">command</span>=/usr/local/tomcat/bin/catalina.sh run</span><br><span class="line">stdout_logfile=/usr/local/tomcat/logs/catalina.out</span><br><span class="line">stderr_logfile=/usr/local/tomcat/logs/catalina.out</span><br><span class="line">environment=JAVA_HOME=<span class="string">&quot;/usr/local/jdk1.8.0_144&quot;</span>,JAVA_BIN=<span class="string">&quot;/usr/local/jdk1.8.0_144/bin&quot;</span></span><br><span class="line">autorestart=<span class="literal">false</span></span><br><span class="line">startsecs=60</span><br><span class="line">priority=1</span><br><span class="line">stopasgroup=<span class="literal">true</span></span><br><span class="line">killasgroup=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶">åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶</h2>
<ul>
<li>æ–°å»ºæ–‡ä»¶ï¼Œfastapi_app.conf</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[group:fastapi]</span><br><span class="line">programs=fastapi-app</span><br><span class="line"></span><br><span class="line">[program:fastapi-1]</span><br><span class="line">command=/home/python/scripts/fastapi1_app.sh</span><br><span class="line">directory=/home/python/fastapi-1-backend</span><br><span class="line">user=python</span><br><span class="line">autorestart=true</span><br><span class="line">redirect_stderr=false</span><br><span class="line">loglevel=info</span><br><span class="line">stopsignal=KILL</span><br><span class="line">stopasgroup=true</span><br><span class="line">killasgroup=true</span><br><span class="line"></span><br><span class="line">[program:fastapi-2]</span><br><span class="line">command=/home/python/scripts/fastapi-2.sh</span><br><span class="line">directory=/home/python/fastapi-2-backend</span><br><span class="line">user=python</span><br><span class="line">autorestart=true</span><br><span class="line">redirect_stderr=false</span><br><span class="line">loglevel=info</span><br><span class="line">stopsignal=KILL</span><br><span class="line">stopasgroup=true</span><br><span class="line">killasgroup=true</span><br></pre></td></tr></table></figure>
<h2 id="å¸¸è§é—®é¢˜ï¼š">å¸¸è§é—®é¢˜ï¼š</h2>
<h3 id="é—®é¢˜1ï¼šunix-tmp-supervisor-sock-no-such-fileçš„é—®é¢˜">é—®é¢˜1ï¼šunix:///tmp/supervisor.sock no such fileçš„é—®é¢˜</h3>
<ul>
<li>åœ¨supervisoré»˜è®¤é…ç½®ä¸­ï¼Œå…¶å¯åŠ¨çš„sockç­‰éƒ½ä¼šæ”¾åˆ°tmpç›®å½•ï¼Œè€Œtmpç›®å½•ä¼šè‡ªåŠ¨æ¸…ç†å¯¼è‡´æ— æ³•ä½¿ç”¨supervisorctl</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/supervisord.conf</span><br><span class="line"></span><br><span class="line">#step1: å°†é…ç½®æ–‡ä»¶ä¸­çš„tmpæ›¿æ¢æ‰ï¼Œå¦åˆ™å®¹æ˜“è¢«linuxè‡ªåŠ¨æ¸…é™¤</span><br><span class="line">/tmp/supervisor.sock æ”¹æˆ /var/run/supervisor.sockï¼Œ</span><br><span class="line">/tmp/supervisord.log æ”¹æˆ /var/log/supervisor.logï¼Œ</span><br><span class="line">/tmp/supervisord.pid æ”¹æˆ /var/run/supervisor.pid</span><br><span class="line"></span><br><span class="line"># step2:ä¿®æ”¹æƒé™ï¼Œå¦‚æœä¸ä¿®æ”¹ï¼Œå¯åŠ¨æ—¶ä¼šæŠ¥é”™æ— æƒé™</span><br><span class="line">sudo chmod 777 /run</span><br><span class="line">sudo chmod 777 /var/log</span><br><span class="line"></span><br><span class="line"># step3: åˆ›å»ºsupervisor.sock</span><br><span class="line">sudo touch /var/run/supervisor.sock</span><br><span class="line">sudo chmod 777 /var/run/supervisor.sock</span><br><span class="line"></span><br><span class="line"># step4: æ€æ‰åŸæ¥çš„è¿›ç¨‹ï¼Œé‡æ–°å¯åŠ¨</span><br><span class="line">supervisord -c /etc/supervisord.conf</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯">é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯</h3>
<ul>
<li>commandä¸­å¯åŠ¨æ–¹å¼ä¸ºåå°å¯åŠ¨ï¼Œå¯¼è‡´è¯†åˆ«ä¸åˆ°pidï¼Œç„¶åä¸æ–­é‡å¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯elasticsearchï¼ŒcommandæŒ‡å®šçš„æ˜¯$path/bin/elasticsearch -d</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§£å†³åŠæ³•ï¼šsupervisoræ— æ³•æ£€æµ‹åå°å¯åŠ¨è¿›ç¨‹çš„pidï¼Œè€Œsupervisoræœ¬èº«å°±æ˜¯åå°å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒè¿™ä¸ª</span><br></pre></td></tr></table></figure>
<h3 id="é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡">é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡</h3>
<ul>
<li>åœ¨è¿è¡Œsupervisord -c /etc/supervisord.confä¹‹å‰ï¼Œç›´æ¥è¿è¡Œè¿‡supervisord -c /etc/supervisord.d/xx.confå¯¼è‡´æœ‰äº›è¿›ç¨‹è¢«å¤šä¸ªsuperviordç®¡ç†ï¼Œæ— æ³•æ­£å¸¸å…³é—­è¿›ç¨‹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§£å†³åŠæ³•ï¼šä½¿ç”¨ps -fe | grep supervisordæŸ¥çœ‹æ‰€æœ‰å¯åŠ¨è¿‡çš„supervisordæœåŠ¡ï¼Œ<span class="built_in">kill</span>ç›¸å…³çš„è¿›ç¨‹ã€‚</span><br></pre></td></tr></table></figure>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2025-03-04</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« sswfive</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/python%E5%BA%93/'>
                            pythonåº“
                        </a>
                    
                        <a href='/tags/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/'>
                            è¿›ç¨‹ç®¡ç†
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/Python/'>
                            Python
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>ä¸Šä¸€ç¯‡ï¼š<a href='/2025/03/04/10-subprocess/'>å­è¿›ç¨‹ç®¡ç†å·¥å…·ä¹‹subprocess</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">ä¸‹ä¸€ç¯‡ï¼š<a href="/2025/03/04/08-apscheduler/">ä»»åŠ¡ç®¡ç†å·¥å…·ä¹‹APScheduler</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            Â© 2018ï½2025 China 

            
                

            
        </span>
       
    
</div>



<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // å¯ç”¨æ’ä»¶
            thumbnail: true,          // æ˜¾ç¤ºç¼©ç•¥å›¾
            zoom: true,               // å¯ç”¨ç¼©æ”¾åŠŸ
            rotate: true,             // å¯ç”¨æ—‹è½¬åŠŸèƒ½èƒ½
            autoplay: true,        // å¯ç”¨è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½
            fullScreen: true,      // å¯ç”¨å…¨å±åŠŸèƒ½
            pager: false, //é¡µç ,
            zoomFromOrigin: true,   // ä»åŸå§‹ä½ç½®ç¼©æ”¾
            actualSize: true,       // å¯ç”¨æŸ¥çœ‹å®é™…å¤§å°çš„åŠŸèƒ½
            enableZoomAfter: 300,    // å»¶è¿Ÿç¼©æ”¾ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆåå¯ç¼©æ”¾
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // ä¿®å¤é€‰æ‹©å™¨
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>
||||||| 4fe7d0d
=======
<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="è¿›ç¨‹ç®¡ç†å·¥å…·ä¹‹Supervisor" />
    <meta name="hexo-theme-A4" content="v1.9.7" />
    <link rel="alternate icon" type="image/webp" href="/img/head.png">
    <title>PyShen</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #e4e4e4 ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: 'ğŸŒ“', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <style>
            .header-img {
                width: 56px;
                height: auto;
                object-fit: cover; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ */
                transition: transform 0.3s ease-in-out; 
                border-radius: 0; 
            }
            
        </style>
        <img 
            alt="^-^" 
            cache-control="max-age=86400" 
            class="header-img" 
            src="/img/head.png" 
        />
        <div class="header-content">
            <a class="logo" href="/">PyShen</a> 
            <span class="description"></span> 
        </div>
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/about/">å…³äº</a></li>
            
        
            
                <li><a href="/tags/">æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    è¿›ç¨‹ç®¡ç†å·¥å…·ä¹‹Supervisor
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>æœ€è¿‘æ›´æ–°ï¼š2025-03-04</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>å­—æ•°æ€»è®¡ï¼š6.6k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>é˜…è¯»ä¼°æ—¶ï¼š26åˆ†é’Ÿ</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        é˜…è¯»é‡ï¼š<span id="busuanzi_value_page_pv"></span>æ¬¡
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A6%82%E8%BF%B0%EF%BC%9A"><span class="post-toc-text">æ¦‚è¿°ï¼š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="post-toc-text">ä½¿ç”¨ï¼š</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%89%E8%A3%85"><span class="post-toc-text">å®‰è£…</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="post-toc-text">å¸¸ç”¨å‘½ä»¤ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="post-toc-text">å¿«é€Ÿä½¿ç”¨ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E8%AF%BB%EF%BC%9A"><span class="post-toc-text">é…ç½®æ–‡ä»¶è§£è¯»ï¼š</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E8%A7%A3%E8%AF%BB"><span class="post-toc-text">å¸¸ç”¨é…ç½®è§£è¯»</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%AF%A6%E7%BB%86%E9%85%8D%E7%BD%AE%E8%A7%A3%E8%AF%BB%EF%BC%9A"><span class="post-toc-text">è¯¦ç»†é…ç½®è§£è¯»ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Supervisor%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="post-toc-text">Supervisoræ§åˆ¶å°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%86%E7%BB%84%E7%AE%A1%E7%90%86"><span class="post-toc-text">åˆ†ç»„ç®¡ç†</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Supervisor%E9%85%8D%E7%BD%AE%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8"><span class="post-toc-text">Supervisoré…ç½®å¼€æœºå¯åŠ¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80%EF%BC%9A"><span class="post-toc-text">æ–¹å¼ä¸€ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A"><span class="post-toc-text">æ–¹å¼äºŒï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B"><span class="post-toc-text">é…ç½®æ¡ˆä¾‹:</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Django%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">Djangoçš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Celery%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">Celeryçš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">Redisçš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#tomcat%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">tomcatçš„é…ç½®æ–‡ä»¶</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%86%E7%BB%84%E7%AE%A1%E7%90%86%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="post-toc-text">åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="post-toc-text">å¸¸è§é—®é¢˜ï¼š</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%981%EF%BC%9Aunix-tmp-supervisor-sock-no-such-file%E7%9A%84%E9%97%AE%E9%A2%98"><span class="post-toc-text">é—®é¢˜1ï¼šunix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock no such fileçš„é—®é¢˜</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%982%EF%BC%9Acommand%E4%B8%AD%E6%8C%87%E5%AE%9A%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%B7%B2%E7%BB%8F%E8%B5%B7%E6%9D%A5%EF%BC%8C%E4%BD%86supervisor%E8%BF%98%E4%B8%8D%E6%96%AD%E9%87%8D%E5%90%AF"><span class="post-toc-text">é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%983%EF%BC%9A%E5%90%AF%E5%8A%A8%E4%BA%86%E5%A4%9A%E4%B8%AAsupervisord%E6%9C%8D%E5%8A%A1%EF%BC%8C%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E5%85%B3%E9%97%AD%E6%9C%8D%E5%8A%A1"><span class="post-toc-text">é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡</span></a></li></ol></li></ol>
            
        
        <div class=".article-gallery"><h2 id="æ¦‚è¿°ï¼š"><a href="#æ¦‚è¿°ï¼š" class="headerlink" title="æ¦‚è¿°ï¼š"></a>æ¦‚è¿°ï¼š</h2><blockquote>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="http://supervisord.org/">http://supervisord.org/</a></p>
</blockquote>
<p>supervisoræ˜¯ç”¨pythonå¼€å‘çš„ä¸€æ¬¾ç”¨äºlinuxæ“ä½œç³»ç»Ÿçš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œsupervisorå¯ä»¥é«˜æ•ˆåœ°å®ç°å¯¹è¿›ç¨‹çŠ¶æ€çš„ç›‘æ§åŠç»Ÿä¸€ç®¡ç†</p>
<ul>
<li>supervisoråˆ†ä¸ºsupervisordï¼ˆæœåŠ¡ç«¯ï¼‰å’Œsupervisorctlï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸¤éƒ¨åˆ†</li>
<li>supervisordä½œä¸ºæœåŠ¡ç«¯è´Ÿè´£æ‰€æœ‰çš„æ³¨å†Œè¿›ç¨‹çš„å¯åŠ¨åŠç›‘æ§ï¼Œå‡ºç°å´©æºƒçš„æœåŠ¡æ—¶ä¼šè‡ªåŠ¨é‡å¯</li>
<li>supervisorctlæ˜¯å®¢æˆ·ç«¯ï¼Œå¯ä»¥å®ç°å¯¹å­è¿›ç¨‹çš„ç®¡ç†ï¼Œå¦‚å¯åŠ¨ã€åœæ­¢ã€é‡å¯ç­‰</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>supervisord è¦æ±‚ç®¡ç†çš„ç¨‹åºæ˜¯é daemon ç¨‹åºï¼Œ å› æ­¤ç”¨supervisord æ¥ç®¡ç†è¿›ç¨‹ï¼Œè¿›ç¨‹éœ€è¦ä»¥édaemonçš„æ–¹å¼å¯åŠ¨ã€‚<ul>
<li>ä¾‹å¦‚ï¼šç®¡ç†nginxï¼Œå¿…é¡»åœ¨ nginx çš„é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä¸€è¡Œè®¾ç½® daemon off è®© nginx ä»¥é daemon æ–¹å¼å¯åŠ¨ã€‚</li>
</ul>
</li>
<li>æ¯æ¬¡ä¿®æ”¹é…ç½®æ–‡ä»¶åéœ€è¿›å…¥ supervisorctlï¼Œæ‰§è¡Œ reloadï¼Œ æ”¹åŠ¨éƒ¨åˆ†æ‰èƒ½ç”Ÿæ•ˆã€‚</li>
</ul>
<h2 id="ä½¿ç”¨ï¼š"><a href="#ä½¿ç”¨ï¼š" class="headerlink" title="ä½¿ç”¨ï¼š"></a>ä½¿ç”¨ï¼š</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install supervisor</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆé…ç½®æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„ï¼ˆæ­¤å¤„è·¯å¾„æŒ‡å®šä¸ºäº†/etc/supervisord.confï¼‰</span></span><br><span class="line">echo_supervisord_conf &gt; /etc/supervisord.conf</span><br></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨å‘½ä»¤ï¼š"><a href="#å¸¸ç”¨å‘½ä»¤ï¼š" class="headerlink" title="å¸¸ç”¨å‘½ä»¤ï¼š"></a>å¸¸ç”¨å‘½ä»¤ï¼š</h3><ul>
<li>supervisord: æœåŠ¡ç«¯å‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">supervisord -c /etc/supervisord.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦åœ¨è¿è¡Œ</span></span><br><span class="line">ps aux | grep supervisord</span><br></pre></td></tr></table></figure>

<ul>
<li>supervisorctl: å®¢æˆ·ç«¯å‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl status                         <span class="comment"># æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line">supervisorctl start program_name             <span class="comment"># å¯åŠ¨program_nameè¿›ç¨‹</span></span><br><span class="line">supervisorctl stop program_name              <span class="comment"># ç»ˆæ­¢program_nameè¿›ç¨‹</span></span><br><span class="line">supervisorctl restart program_name           <span class="comment"># é‡å¯program_nameè¿›ç¨‹</span></span><br><span class="line">supervisorctl reread                         <span class="comment"># æ›´æ–°é…ç½®ï¼Œæ ¹æ®æœ€æ–°çš„é…ç½®å¯åŠ¨æ‰€æœ‰ç¨‹åº</span></span><br><span class="line">supervisorctl update                         <span class="comment"># æ›´æ–°é…ç½®ï¼Œé‡å¯é…ç½®æœ‰å˜åŒ–çš„è¿›ç¨‹</span></span><br></pre></td></tr></table></figure>

<ul>
<li>supervisorctl: shellå‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl                <span class="comment"># è¿›å…¥shellå‘½ä»¤è¡Œ</span></span><br><span class="line">&gt; status                     <span class="comment"># æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line">&gt; start program_name         <span class="comment"># å¯åŠ¨program_nameè¿›ç¨‹</span></span><br><span class="line">&gt; stop program_name          <span class="comment"># ç»ˆæ­¢program_nameè¿›ç¨‹</span></span><br><span class="line">&gt; restart program_name       <span class="comment"># é‡å¯program_nameè¿›ç¨‹</span></span><br><span class="line">&gt; reread                     <span class="comment"># æ›´æ–°é…ç½®ï¼Œæ ¹æ®æœ€æ–°çš„é…ç½®å¯åŠ¨æ‰€æœ‰ç¨‹åº</span></span><br><span class="line">&gt; update                     <span class="comment"># æ›´æ–°é…ç½®ï¼Œé‡å¯é…ç½®æœ‰å˜åŒ–çš„è¿›ç¨‹</span></span><br><span class="line">&gt; start fastapi:*            <span class="comment"># å¯åŠ¨ fastapiç»„ ç¨‹åº</span></span><br><span class="line">&gt; stop fastapi:*             <span class="comment"># åœæ­¢ fastapiç»„ ç¨‹åº</span></span><br></pre></td></tr></table></figure>

<h3 id="å¿«é€Ÿä½¿ç”¨ï¼š"><a href="#å¿«é€Ÿä½¿ç”¨ï¼š" class="headerlink" title="å¿«é€Ÿä½¿ç”¨ï¼š"></a>å¿«é€Ÿä½¿ç”¨ï¼š</h3><ul>
<li>step1ï¼šç¼–è¾‘supervisoré…ç½®æ–‡ä»¶<ul>
<li>åœ¨é…ç½®æ–‡ä»¶çš„æœ«å°¾åŠ ä¸Š[include]å†…å®¹</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">[include]</span><br><span class="line">files=/etc/supervisor.d/*.conf  <span class="comment">#è‹¥ä½ æœ¬åœ°æ— /etc/supervisor.dç›®å½•ï¼Œè¯·è‡ªå»º</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li>step2ï¼šæ–°å»º&#x2F;etc&#x2F;supervisor.d&#x2F;.demo.conf é…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[program:è‡ªå®šä¹‰çš„æœåŠ¡åç§°]</span><br><span class="line"><span class="built_in">command</span>=python3 /xxxx/main.py  <span class="comment">#æœåŠ¡çš„å¯åŠ¨å‘½ä»¤ï¼Œåœ¨è¿™é‡Œç”¨çš„pythonç¯å¢ƒä¸ºsupervisorå®‰è£…çš„ç¯å¢ƒï¼Œè‹¥æƒ³æŒ‡å®šå…¶ä»–pythonç¯å¢ƒåˆ™å¯æŒ‡å®špythonåŒ…çš„ä½ç½®å¦‚command=xxxx/xxxx/bin/python3 /xxxx/main.pyä¾¿å¯</span></span><br><span class="line">process_name=%(program_name)s</span><br><span class="line">stdout_logfile=/home/task.log  <span class="comment">#è¾“å‡ºæ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå¯æ ¹æ®éœ€è¦è‡ªå®šä¹‰</span></span><br><span class="line">stderr_logfile=/home/task.log  <span class="comment">#æŠ¥é”™æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå¯æ ¹æ®éœ€è¦è‡ªå®šä¹‰</span></span><br></pre></td></tr></table></figure>

<ul>
<li>step3:å¯åŠ¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">supervisord -c /etc/supervisor.conf</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®æ–‡ä»¶è§£è¯»ï¼š"><a href="#é…ç½®æ–‡ä»¶è§£è¯»ï¼š" class="headerlink" title="é…ç½®æ–‡ä»¶è§£è¯»ï¼š"></a>é…ç½®æ–‡ä»¶è§£è¯»ï¼š</h2><h3 id="å¸¸ç”¨é…ç½®è§£è¯»"><a href="#å¸¸ç”¨é…ç½®è§£è¯»" class="headerlink" title="å¸¸ç”¨é…ç½®è§£è¯»"></a>å¸¸ç”¨é…ç½®è§£è¯»</h3><ul>
<li>æ‰“å¼€é…ç½®æ–‡ä»¶ï¼š &#x2F;etc&#x2F;supervisord.conf</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[unix_http_server]</span><br><span class="line">file=/tmp/supervisor.sock   ;UNIX socket æ–‡ä»¶ï¼Œsupervisorctl ä¼šä½¿ç”¨</span><br><span class="line">;<span class="built_in">chmod</span>=0700                 ;socketæ–‡ä»¶çš„modeï¼Œé»˜è®¤æ˜¯0700</span><br><span class="line">;<span class="built_in">chown</span>=nobody:nogroup       ;socketæ–‡ä»¶çš„ownerï¼Œæ ¼å¼ï¼šuid:gid</span><br><span class="line"></span><br><span class="line">[inet_http_server]         ;HTTPæœåŠ¡å™¨ï¼Œæä¾›webç®¡ç†ç•Œé¢</span><br><span class="line">port=0.0.0.0:9001          ;Webç®¡ç†åå°è¿è¡Œçš„IPå’Œç«¯å£ï¼Œå¦‚æœå¼€æ”¾åˆ°å…¬ç½‘ï¼Œéœ€è¦æ³¨æ„å®‰å…¨æ€§</span><br><span class="line">username=user              ;ç™»å½•ç®¡ç†åå°çš„ç”¨æˆ·å</span><br><span class="line">password=123               ;ç™»å½•ç®¡ç†åå°çš„å¯†ç </span><br><span class="line"></span><br><span class="line">[supervisord]</span><br><span class="line">logfile=/tmp/supervisord.log ;æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ <span class="variable">$CWD</span>/supervisord.log</span><br><span class="line">logfile_maxbytes=50MB        ;æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºä¼šrotateï¼Œé»˜è®¤ 50MBï¼Œå¦‚æœè®¾æˆ0ï¼Œè¡¨ç¤ºä¸é™åˆ¶å¤§å°</span><br><span class="line">logfile_backups=10           ;æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤‡ä»½æ•°é‡é»˜è®¤10ï¼Œè®¾ä¸º0è¡¨ç¤ºä¸å¤‡ä»½</span><br><span class="line">loglevel=info                ;æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤infoï¼Œå…¶å®ƒ: debug,warn,trace</span><br><span class="line">pidfile=/tmp/supervisord.pid ;pid æ–‡ä»¶</span><br><span class="line">nodaemon=<span class="literal">false</span>               ;æ˜¯å¦åœ¨å‰å°å¯åŠ¨ï¼Œé»˜è®¤æ˜¯<span class="literal">false</span>ï¼Œå³ä»¥ daemon çš„æ–¹å¼å¯åŠ¨</span><br><span class="line">minfds=1024                  ;å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„æœ€å°å€¼ï¼Œé»˜è®¤ 1024</span><br><span class="line">minprocs=200                 ;å¯ä»¥æ‰“å¼€çš„è¿›ç¨‹æ•°çš„æœ€å°å€¼ï¼Œé»˜è®¤ 200</span><br><span class="line"></span><br><span class="line">[supervisorctl]</span><br><span class="line">serverurl=unix:///tmp/supervisor.sock ;é€šè¿‡UNIX socketè¿æ¥supervisordï¼Œè·¯å¾„ä¸unix_http_serveréƒ¨åˆ†çš„fileä¸€è‡´</span><br><span class="line">;serverurl=http://127.0.0.1:9001 ; é€šè¿‡HTTPçš„æ–¹å¼è¿æ¥supervisord</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸Šä¸œè¥¿éƒ½ä¸éœ€è¦æ”¹ï¼Œå°±åŠ ä¸‹é¢è¿™è¡Œ</span></span><br><span class="line">[include]</span><br><span class="line">files=/etc/supervisor.d/*.conf  <span class="comment">#è‹¥ä½ æœ¬åœ°æ— /etc/supervisor.dç›®å½•ï¼Œè¯·è‡ªå»º</span></span><br></pre></td></tr></table></figure>
<h3 id="è¯¦ç»†é…ç½®è§£è¯»ï¼š"><a href="#è¯¦ç»†é…ç½®è§£è¯»ï¼š" class="headerlink" title="è¯¦ç»†é…ç½®è§£è¯»ï¼š"></a>è¯¦ç»†é…ç½®è§£è¯»ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br></pre></td><td class="code"><pre><span class="line">[unix_http_server]            </span><br><span class="line"> </span><br><span class="line">file=/tmp/supervisor.sock   ; socketæ–‡ä»¶çš„è·¯å¾„ï¼Œsupervisorctlç”¨XML_RPCå’Œsupervisordé€šä¿¡å°±æ˜¯é€šè¿‡å®ƒè¿›è¡Œ</span><br><span class="line"> </span><br><span class="line">                              çš„ã€‚å¦‚æœä¸è®¾ç½®çš„è¯ï¼Œsupervisorctlä¹Ÿå°±ä¸èƒ½ç”¨äº†  </span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºnoneã€‚ éå¿…é¡»è®¾ç½®        </span><br><span class="line"> </span><br><span class="line">;<span class="built_in">chmod</span>=0700                 ; è¿™ä¸ªç®€å•ï¼Œå°±æ˜¯ä¿®æ”¹ä¸Šé¢çš„é‚£ä¸ªsocketæ–‡ä»¶çš„æƒé™ä¸º0700</span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸º0700ã€‚ éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">chown</span>=nobody:nogroup       ; è¿™ä¸ªä¸€æ ·ï¼Œä¿®æ”¹ä¸Šé¢çš„é‚£ä¸ªsocketæ–‡ä»¶çš„å±ç»„ä¸ºuser.group</span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºå¯åŠ¨supervisordè¿›ç¨‹çš„ç”¨æˆ·åŠå±ç»„ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;username=user              ; ä½¿ç”¨supervisorctlè¿æ¥çš„æ—¶å€™ï¼Œè®¤è¯çš„ç”¨æˆ·</span><br><span class="line"> </span><br><span class="line">                               ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºä¸éœ€è¦ç”¨æˆ·ã€‚ éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;password=123               ; å’Œä¸Šé¢çš„ç”¨æˆ·åå¯¹åº”çš„å¯†ç ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æ˜ç ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨SHAåŠ å¯†</span><br><span class="line"> </span><br><span class="line">                              å¦‚ï¼š&#123;SHA&#125;82ab876d1387bfafe46cc1c8a2ef074eae50cb1d</span><br><span class="line"> </span><br><span class="line">                              é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;[inet_http_server]         ; ä¾¦å¬åœ¨TCPä¸Šçš„socketï¼ŒWeb Serverå’Œè¿œç¨‹çš„supervisorctléƒ½è¦ç”¨åˆ°ä»–</span><br><span class="line"> </span><br><span class="line">                              ä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤ä¸ºä¸å¼€å¯ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;port=127.0.0.1:9001        ; è¿™ä¸ªæ˜¯ä¾¦å¬çš„IPå’Œç«¯å£ï¼Œä¾¦å¬æ‰€æœ‰IPç”¨ :9001æˆ–*:9001ã€‚</span><br><span class="line"> </span><br><span class="line">                              è¿™ä¸ªå¿…é¡»è®¾ç½®ï¼Œåªè¦ä¸Šé¢çš„[inet_http_server]å¼€å¯äº†ï¼Œå°±å¿…é¡»è®¾ç½®å®ƒ</span><br><span class="line"> </span><br><span class="line">;username=user              ; è¿™ä¸ªå’Œä¸Šé¢çš„uinx_http_serverä¸€ä¸ªæ ·ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;password=123               ; è¿™ä¸ªä¹Ÿä¸€ä¸ªæ ·ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">[supervisord]                ;è¿™ä¸ªä¸»è¦æ˜¯å®šä¹‰supervisordè¿™ä¸ªæœåŠ¡ç«¯è¿›ç¨‹çš„ä¸€äº›å‚æ•°çš„</span><br><span class="line"> </span><br><span class="line">                              è¿™ä¸ªå¿…é¡»è®¾ç½®ï¼Œä¸è®¾ç½®ï¼Œsupervisorå°±ä¸ç”¨å¹²æ´»äº†</span><br><span class="line"> </span><br><span class="line">logfile=/tmp/supervisord.log ; è¿™ä¸ªæ˜¯supervisordè¿™ä¸ªä¸»è¿›ç¨‹çš„æ—¥å¿—è·¯å¾„ï¼Œæ³¨æ„å’Œå­è¿›ç¨‹çš„æ—¥å¿—ä¸æ­å˜ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤è·¯å¾„<span class="variable">$CWD</span>/supervisord.logï¼Œ<span class="variable">$CWD</span>æ˜¯å½“å‰ç›®å½•ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">logfile_maxbytes=50MB        ; è¿™ä¸ªæ˜¯ä¸Šé¢é‚£ä¸ªæ—¥å¿—æ–‡ä»¶çš„æœ€å¤§çš„å¤§å°ï¼Œå½“è¶…è¿‡50Mçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ—¥ </span><br><span class="line"> </span><br><span class="line">                               å¿—æ–‡ä»¶ã€‚å½“è®¾ç½®ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸é™åˆ¶æ–‡ä»¶å¤§å°</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤å€¼æ˜¯50Mï¼Œéå¿…é¡»è®¾ç½®ã€‚              </span><br><span class="line"> </span><br><span class="line">logfile_backups=10           ; æ—¥å¿—æ–‡ä»¶ä¿æŒçš„æ•°é‡ï¼Œä¸Šé¢çš„æ—¥å¿—æ–‡ä»¶å¤§äº50Mæ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°æ–‡ä»¶ã€‚æ–‡ä»¶</span><br><span class="line"> </span><br><span class="line">                               æ•°é‡å¤§äº10æ—¶ï¼Œæœ€åˆçš„è€æ–‡ä»¶è¢«æ–°æ–‡ä»¶è¦†ç›–ï¼Œæ–‡ä»¶æ•°é‡å°†ä¿æŒä¸º10</span><br><span class="line"> </span><br><span class="line">                               å½“è®¾ç½®ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸é™åˆ¶æ–‡ä»¶çš„æ•°é‡ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æƒ…å†µä¸‹ä¸º10ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">loglevel=info                ; æ—¥å¿—çº§åˆ«ï¼Œæœ‰critical, error, warn, info, debug, trace, or blatherç­‰</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸ºinfoã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">pidfile=/tmp/supervisord.pid ; supervisordçš„pidæ–‡ä»¶è·¯å¾„ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º<span class="variable">$CWD</span>/supervisord.pidã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">nodaemon=<span class="literal">false</span>               ; å¦‚æœæ˜¯<span class="literal">true</span>ï¼Œsupervisordè¿›ç¨‹å°†åœ¨å‰å°è¿è¡Œ</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º<span class="literal">false</span>ï¼Œä¹Ÿå°±æ˜¯åå°ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">minfds=1024                  ; è¿™ä¸ªæ˜¯æœ€å°‘ç³»ç»Ÿç©ºé—²çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä½äºè¿™ä¸ªå€¼supervisorå°†ä¸ä¼šå¯åŠ¨ã€‚</span><br><span class="line"> </span><br><span class="line">                               ç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦åœ¨è¿™é‡Œè®¾ç½®<span class="built_in">cat</span> /proc/sys/fs/file-max</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æƒ…å†µä¸‹ä¸º1024ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">minprocs=200                 ; æœ€å°å¯ç”¨çš„è¿›ç¨‹æè¿°ç¬¦ï¼Œä½äºè¿™ä¸ªå€¼supervisorä¹Ÿå°†ä¸ä¼šæ­£å¸¸å¯åŠ¨ã€‚</span><br><span class="line"> </span><br><span class="line">                              <span class="built_in">ulimit</span>  -uè¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹linuxä¸‹é¢ç”¨æˆ·çš„æœ€å¤§è¿›ç¨‹æ•°</span><br><span class="line"> </span><br><span class="line">                              é»˜è®¤ä¸º200ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">umask</span>=022                   ; è¿›ç¨‹åˆ›å»ºæ–‡ä»¶çš„æ©ç </span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º022ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;user=chrism                 ; è¿™ä¸ªå‚æ•°å¯ä»¥è®¾ç½®ä¸€ä¸ªérootç”¨æˆ·ï¼Œå½“æˆ‘ä»¬ä»¥rootç”¨æˆ·å¯åŠ¨supervisordä¹‹åã€‚</span><br><span class="line"> </span><br><span class="line">                               æˆ‘è¿™é‡Œé¢è®¾ç½®çš„è¿™ä¸ªç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥å¯¹supervisordè¿›è¡Œç®¡ç†</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æƒ…å†µæ˜¯ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;identifier=supervisor       ; è¿™ä¸ªå‚æ•°æ˜¯supervisordçš„æ ‡è¯†ç¬¦ï¼Œä¸»è¦æ˜¯ç»™XML_RPCç”¨çš„ã€‚å½“ä½ æœ‰å¤šä¸ª</span><br><span class="line"> </span><br><span class="line">                               supervisorçš„æ—¶å€™ï¼Œè€Œä¸”æƒ³è°ƒç”¨XML_RPCç»Ÿä¸€ç®¡ç†ï¼Œå°±éœ€è¦ä¸ºæ¯ä¸ª</span><br><span class="line"> </span><br><span class="line">                               supervisorè®¾ç½®ä¸åŒçš„æ ‡è¯†ç¬¦äº†</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æ˜¯supervisordã€‚ã€‚ã€‚éå¿…éœ€è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;directory=/tmp              ; è¿™ä¸ªå‚æ•°æ˜¯å½“supervisordä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°çš„è¯ï¼Œå¯åŠ¨</span><br><span class="line"> </span><br><span class="line">                               supervisordè¿›ç¨‹ä¹‹å‰ï¼Œä¼šå…ˆåˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;nocleanup=<span class="literal">true</span>              ; è¿™ä¸ªå‚æ•°å½“ä¸º<span class="literal">false</span>çš„æ—¶å€™ï¼Œä¼šåœ¨supervisordè¿›ç¨‹å¯åŠ¨çš„æ—¶å€™ï¼ŒæŠŠä»¥å‰å­è¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                               äº§ç”Ÿçš„æ—¥å¿—æ–‡ä»¶(è·¯å¾„ä¸ºAUTOçš„æƒ…å†µä¸‹)æ¸…é™¤æ‰ã€‚æœ‰æ—¶å€™å’±ä»¬æƒ³è¦çœ‹å†å²æ—¥å¿—ï¼Œå½“ </span><br><span class="line"> </span><br><span class="line">                               ç„¶ä¸æƒ³æ—¥å¿—è¢«æ¸…é™¤äº†ã€‚æ‰€ä»¥å¯ä»¥è®¾ç½®ä¸º<span class="literal">true</span></span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æ˜¯<span class="literal">false</span>ï¼Œæœ‰è°ƒè¯•éœ€æ±‚çš„åŒå­¦å¯ä»¥è®¾ç½®ä¸º<span class="literal">true</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;childlogdir=/tmp            ; å½“å­è¿›ç¨‹æ—¥å¿—è·¯å¾„ä¸ºAUTOçš„æ—¶å€™ï¼Œå­è¿›ç¨‹æ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤è·¯å¾„æ˜¯è¿™ä¸ªä¸œè¥¿ï¼Œæ‰§è¡Œä¸‹é¢çš„è¿™ä¸ªå‘½ä»¤çœ‹çœ‹å°±OKäº†ï¼Œå¤„ç†çš„ä¸œè¥¿å°±é»˜è®¤è·¯å¾„</span><br><span class="line"> </span><br><span class="line">                               python -c <span class="string">&quot;import tempfile;print tempfile.gettempdir()&quot;</span></span><br><span class="line"> </span><br><span class="line">                               éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;environment=KEY=<span class="string">&quot;value&quot;</span>     ; è¿™ä¸ªæ˜¯ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡çš„ï¼Œsupervisordåœ¨linuxä¸­å¯åŠ¨é»˜è®¤ç»§æ‰¿äº†linuxçš„</span><br><span class="line"> </span><br><span class="line">                               ç¯å¢ƒå˜é‡ï¼Œåœ¨è¿™é‡Œå¯ä»¥è®¾ç½®supervisordè¿›ç¨‹ç‰¹æœ‰çš„å…¶ä»–ç¯å¢ƒå˜é‡ã€‚</span><br><span class="line"> </span><br><span class="line">                               supervisordå¯åŠ¨å­è¿›ç¨‹æ—¶ï¼Œå­è¿›ç¨‹ä¼šæ‹·è´çˆ¶è¿›ç¨‹çš„å†…å­˜ç©ºé—´å†…å®¹ã€‚ æ‰€ä»¥è®¾ç½®çš„</span><br><span class="line"> </span><br><span class="line">                               è¿™äº›ç¯å¢ƒå˜é‡ä¹Ÿä¼šè¢«å­è¿›ç¨‹ç»§æ‰¿ã€‚</span><br><span class="line"> </span><br><span class="line">                               å°ä¾‹å­ï¼šenvironment=name=<span class="string">&quot;haha&quot;</span>,age=<span class="string">&quot;hehe&quot;</span></span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸ºä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;strip_ansi=<span class="literal">false</span>            ; è¿™ä¸ªé€‰é¡¹å¦‚æœè®¾ç½®ä¸º<span class="literal">true</span>ï¼Œä¼šæ¸…é™¤å­è¿›ç¨‹æ—¥å¿—ä¸­çš„æ‰€æœ‰ANSI åºåˆ—ã€‚ä»€ä¹ˆæ˜¯ANSI</span><br><span class="line"> </span><br><span class="line">                               åºåˆ—å‘¢ï¼Ÿå°±æ˜¯æˆ‘ä»¬çš„\n,\tè¿™äº›ä¸œè¥¿ã€‚</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">; the below section must remain <span class="keyword">in</span> the config file <span class="keyword">for</span> RPC</span><br><span class="line"> </span><br><span class="line">; (supervisorctl/web interface) to work, additional interfaces may be</span><br><span class="line"> </span><br><span class="line">; added by defining them <span class="keyword">in</span> separate rpcinterface: sections</span><br><span class="line"> </span><br><span class="line">[rpcinterface:supervisor]    ;è¿™ä¸ªé€‰é¡¹æ˜¯ç»™XML_RPCç”¨çš„ï¼Œå½“ç„¶ä½ å¦‚æœæƒ³ä½¿ç”¨supervisordæˆ–è€…web server è¿™ </span><br><span class="line"> </span><br><span class="line">                              ä¸ªé€‰é¡¹å¿…é¡»è¦å¼€å¯çš„</span><br><span class="line"> </span><br><span class="line">supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface </span><br><span class="line"> </span><br><span class="line">[supervisorctl]              ;è¿™ä¸ªä¸»è¦æ˜¯é’ˆå¯¹supervisorctlçš„ä¸€äº›é…ç½®  </span><br><span class="line"> </span><br><span class="line">serverurl=unix:///tmp/supervisor.sock ; è¿™ä¸ªæ˜¯supervisorctlæœ¬åœ°è¿æ¥supervisordçš„æ—¶å€™ï¼Œæœ¬åœ°UNIX socket</span><br><span class="line"> </span><br><span class="line">                                        è·¯å¾„ï¼Œæ³¨æ„è¿™ä¸ªæ˜¯å’Œå‰é¢çš„[unix_http_server]å¯¹åº”çš„</span><br><span class="line"> </span><br><span class="line">                                        é»˜è®¤å€¼å°±æ˜¯unix:///tmp/supervisor.sockã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;serverurl=http://127.0.0.1:9001 ; è¿™ä¸ªæ˜¯supervisorctlè¿œç¨‹è¿æ¥supervisordçš„æ—¶å€™ï¼Œç”¨åˆ°çš„TCP socketè·¯å¾„</span><br><span class="line"> </span><br><span class="line">                                   æ³¨æ„è¿™ä¸ªå’Œå‰é¢çš„[inet_http_server]å¯¹åº”</span><br><span class="line"> </span><br><span class="line">                                   é»˜è®¤å°±æ˜¯http://127.0.0.1:9001ã€‚ã€‚ã€‚éå¿…é¡»é¡¹</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">;username=chris              ; ç”¨æˆ·å</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤ç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;password=123                ; å¯†ç </span><br><span class="line"> </span><br><span class="line">                              é»˜è®¤ç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;prompt=mysupervisor         ; è¾“å…¥ç”¨æˆ·åå¯†ç æ—¶å€™çš„æç¤ºç¬¦</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤supervisorã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;history_file=~/.sc_history  ; è¿™ä¸ªå‚æ•°å’Œshellä¸­çš„<span class="built_in">history</span>ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸Šä¸‹é”®æ¥æŸ¥æ‰¾å‰é¢æ‰§è¡Œè¿‡çš„å‘½ä»¤</span><br><span class="line"> </span><br><span class="line">                               é»˜è®¤æ˜¯no fileçš„ã€‚ã€‚æ‰€ä»¥æˆ‘ä»¬æƒ³è¦æœ‰è¿™ç§åŠŸèƒ½ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ã€‚ã€‚ã€‚é</span><br><span class="line"> </span><br><span class="line">                               å¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">; The below sample program section shows all possible program subsection values,</span><br><span class="line"> </span><br><span class="line">; create one or more <span class="string">&#x27;real&#x27;</span> program: sections to be able to control them under</span><br><span class="line"> </span><br><span class="line">; supervisor.</span><br><span class="line"> </span><br><span class="line">;[program:theprogramname]      ;è¿™ä¸ªå°±æ˜¯å’±ä»¬è¦ç®¡ç†çš„å­è¿›ç¨‹äº†ï¼Œ<span class="string">&quot;:&quot;</span>åé¢çš„æ˜¯åå­—ï¼Œæœ€å¥½åˆ«ä¹±å†™å’Œå®é™…è¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                                æœ‰ç‚¹å…³è”æœ€å¥½ã€‚è¿™æ ·çš„programæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œä¸€ä¸ªprogramå°±æ˜¯</span><br><span class="line"> </span><br><span class="line">                                è¦è¢«ç®¡ç†çš„ä¸€ä¸ªè¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">command</span>=/bin/cat              ; è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„è¦å¯åŠ¨è¿›ç¨‹çš„å‘½ä»¤è·¯å¾„äº†ï¼Œå¯ä»¥å¸¦å‚æ•°</span><br><span class="line"> </span><br><span class="line">                                ä¾‹å­ï¼š/home/test.py -a <span class="string">&#x27;hehe&#x27;</span></span><br><span class="line"> </span><br><span class="line">                                æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çš„<span class="built_in">command</span>åªèƒ½æ˜¯é‚£ç§åœ¨ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹ï¼Œä¸èƒ½æ˜¯</span><br><span class="line"> </span><br><span class="line">                                å®ˆæŠ¤è¿›ç¨‹ã€‚è¿™ä¸ªæƒ³æƒ³ä¹ŸçŸ¥é“äº†ï¼Œæ¯”å¦‚è¯´<span class="built_in">command</span>=service httpd startã€‚</span><br><span class="line"> </span><br><span class="line">                                httpdè¿™ä¸ªè¿›ç¨‹è¢«linuxçš„serviceç®¡ç†äº†ï¼Œæˆ‘ä»¬çš„supervisorå†å»å¯åŠ¨è¿™ä¸ªå‘½ä»¤</span><br><span class="line"> </span><br><span class="line">                                è¿™å·²ç»ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰çš„å­è¿›ç¨‹äº†ã€‚</span><br><span class="line"> </span><br><span class="line">                                è¿™ä¸ªæ˜¯ä¸ªå¿…é¡»è®¾ç½®çš„é¡¹</span><br><span class="line"> </span><br><span class="line">;process_name=%(program_name)s ; è¿™ä¸ªæ˜¯è¿›ç¨‹åï¼Œå¦‚æœæˆ‘ä»¬ä¸‹é¢çš„numprocså‚æ•°ä¸º1çš„è¯ï¼Œå°±ä¸ç”¨ç®¡è¿™ä¸ªå‚æ•°</span><br><span class="line"> </span><br><span class="line">                                 äº†ï¼Œå®ƒé»˜è®¤å€¼%(program_name)sä¹Ÿå°±æ˜¯ä¸Šé¢çš„é‚£ä¸ªprogramå†’å·åé¢çš„åå­—ï¼Œ</span><br><span class="line"> </span><br><span class="line">                                 ä½†æ˜¯å¦‚æœnumprocsä¸ºå¤šä¸ªçš„è¯ï¼Œé‚£å°±ä¸èƒ½è¿™ä¹ˆå¹²äº†ã€‚æƒ³æƒ³ä¹ŸçŸ¥é“ï¼Œä¸å¯èƒ½æ¯ä¸ª</span><br><span class="line"> </span><br><span class="line">                                 è¿›ç¨‹éƒ½ç”¨åŒä¸€ä¸ªè¿›ç¨‹åå§ã€‚</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">;numprocs=1                    ; å¯åŠ¨è¿›ç¨‹çš„æ•°ç›®ã€‚å½“ä¸ä¸º1æ—¶ï¼Œå°±æ˜¯è¿›ç¨‹æ± çš„æ¦‚å¿µï¼Œæ³¨æ„process_nameçš„è®¾ç½®</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º1    ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;directory=/tmp                ; è¿›ç¨‹è¿è¡Œå‰ï¼Œä¼šå‰åˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">umask</span>=022                     ; è¿›ç¨‹æ©ç ï¼Œé»˜è®¤noneï¼Œéå¿…é¡»</span><br><span class="line"> </span><br><span class="line">;priority=999                  ; å­è¿›ç¨‹å¯åŠ¨å…³é—­ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§ä½çš„ï¼Œæœ€å…ˆå¯åŠ¨ï¼Œå…³é—­çš„æ—¶å€™æœ€åå…³é—­</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º999 ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;autostart=<span class="literal">true</span>                ; å¦‚æœæ˜¯<span class="literal">true</span>çš„è¯ï¼Œå­è¿›ç¨‹å°†åœ¨supervisordå¯åŠ¨åè¢«è‡ªåŠ¨å¯åŠ¨</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å°±æ˜¯<span class="literal">true</span>   ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;autorestart=unexpected        ; è¿™ä¸ªæ˜¯è®¾ç½®å­è¿›ç¨‹æŒ‚æ‰åè‡ªåŠ¨é‡å¯çš„æƒ…å†µï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹ï¼Œ<span class="literal">false</span>,unexpected</span><br><span class="line"> </span><br><span class="line">                                 å’Œ<span class="literal">true</span>ã€‚å¦‚æœä¸º<span class="literal">false</span>çš„æ—¶å€™ï¼Œæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½ä¸ä¼šè¢«é‡æ–°å¯åŠ¨ï¼Œ</span><br><span class="line"> </span><br><span class="line">                                 å¦‚æœä¸ºunexpectedï¼Œåªæœ‰å½“è¿›ç¨‹çš„é€€å‡ºç ä¸åœ¨ä¸‹é¢çš„exitcodesé‡Œé¢å®šä¹‰çš„é€€ </span><br><span class="line"> </span><br><span class="line">                                 å‡ºç çš„æ—¶å€™ï¼Œæ‰ä¼šè¢«è‡ªåŠ¨é‡å¯ã€‚å½“ä¸º<span class="literal">true</span>çš„æ—¶å€™ï¼Œåªè¦å­è¿›ç¨‹æŒ‚æ‰ï¼Œå°†ä¼šè¢«æ— </span><br><span class="line"> </span><br><span class="line">                                 æ¡ä»¶çš„é‡å¯</span><br><span class="line"> </span><br><span class="line">;startsecs=1                   ; è¿™ä¸ªé€‰é¡¹æ˜¯å­è¿›ç¨‹å¯åŠ¨å¤šå°‘ç§’ä¹‹åï¼Œæ­¤æ—¶çŠ¶æ€å¦‚æœæ˜¯runningï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºå¯</span><br><span class="line"> </span><br><span class="line">                                 åŠ¨æˆåŠŸäº†</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º1 ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;startretries=3                ; å½“è¿›ç¨‹å¯åŠ¨å¤±è´¥åï¼Œæœ€å¤§å°è¯•å¯åŠ¨çš„æ¬¡æ•°ã€‚ã€‚å½“è¶…è¿‡3æ¬¡åï¼Œsupervisorå°†æŠŠ</span><br><span class="line"> </span><br><span class="line">                                 æ­¤è¿›ç¨‹çš„çŠ¶æ€ç½®ä¸ºFAIL</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º3 ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;exitcodes=0,2                 ; æ³¨æ„å’Œä¸Šé¢çš„çš„autorestart=unexpectedå¯¹åº”ã€‚ã€‚exitcodesé‡Œé¢çš„å®šä¹‰çš„</span><br><span class="line"> </span><br><span class="line">                                 é€€å‡ºç æ˜¯expectedçš„ã€‚</span><br><span class="line"> </span><br><span class="line">;stopsignal=QUIT               ; è¿›ç¨‹åœæ­¢ä¿¡å·ï¼Œå¯ä»¥ä¸ºTERM, HUP, INT, QUIT, KILL, USR1, or USR2ç­‰ä¿¡å·</span><br><span class="line"> </span><br><span class="line">                                  é»˜è®¤ä¸ºTERM ã€‚ã€‚å½“ç”¨è®¾å®šçš„ä¿¡å·å»å¹²æ‰è¿›ç¨‹ï¼Œé€€å‡ºç ä¼šè¢«è®¤ä¸ºæ˜¯expected</span><br><span class="line"> </span><br><span class="line">                                  éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stopwaitsecs=10               ; è¿™ä¸ªæ˜¯å½“æˆ‘ä»¬å‘å­è¿›ç¨‹å‘é€stopsignalä¿¡å·åï¼Œåˆ°ç³»ç»Ÿè¿”å›ä¿¡æ¯</span><br><span class="line"> </span><br><span class="line">                                 ç»™supervisordï¼Œæ‰€ç­‰å¾…çš„æœ€å¤§æ—¶é—´ã€‚ è¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œsupervisordä¼šå‘è¯¥</span><br><span class="line"> </span><br><span class="line">                                 å­è¿›ç¨‹å‘é€ä¸€ä¸ªå¼ºåˆ¶<span class="built_in">kill</span>çš„ä¿¡å·ã€‚</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º10ç§’ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stopasgroup=<span class="literal">false</span>             ; è¿™ä¸ªä¸œè¥¿ä¸»è¦ç”¨äºï¼Œsupervisordç®¡ç†çš„å­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹æœ¬èº«è¿˜æœ‰</span><br><span class="line"> </span><br><span class="line">                                 å­è¿›ç¨‹ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚æœä»…ä»…å¹²æ‰supervisordçš„å­è¿›ç¨‹çš„è¯ï¼Œå­è¿›ç¨‹çš„å­è¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                                 æœ‰å¯èƒ½ä¼šå˜æˆå­¤å„¿è¿›ç¨‹ã€‚æ‰€ä»¥å’±ä»¬å¯ä»¥è®¾ç½®å¯ä¸ªé€‰é¡¹ï¼ŒæŠŠæ•´ä¸ªè¯¥å­è¿›ç¨‹çš„</span><br><span class="line"> </span><br><span class="line">                                 æ•´ä¸ªè¿›ç¨‹ç»„éƒ½å¹²æ‰ã€‚ è®¾ç½®ä¸º<span class="literal">true</span>çš„è¯ï¼Œä¸€èˆ¬killasgroupä¹Ÿä¼šè¢«è®¾ç½®ä¸º<span class="literal">true</span>ã€‚</span><br><span class="line"> </span><br><span class="line">                                 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥é€‰é¡¹å‘é€çš„æ˜¯stopä¿¡å·</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚éå¿…é¡»è®¾ç½®ã€‚ã€‚</span><br><span class="line"> </span><br><span class="line">;killasgroup=<span class="literal">false</span>             ; è¿™ä¸ªå’Œä¸Šé¢çš„stopasgroupç±»ä¼¼ï¼Œä¸è¿‡å‘é€çš„æ˜¯<span class="built_in">kill</span>ä¿¡å·</span><br><span class="line"> </span><br><span class="line">;user=chrism                   ; å¦‚æœsupervisordæ˜¯rootå¯åŠ¨ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®è¿™ä¸ªérootç”¨æˆ·ï¼Œå¯ä»¥ç”¨æ¥</span><br><span class="line"> </span><br><span class="line">                                 ç®¡ç†è¯¥program</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸è®¾ç½®ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;redirect_stderr=<span class="literal">true</span>          ; å¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™stderrçš„æ—¥å¿—ä¼šè¢«å†™å…¥stdoutæ—¥å¿—æ–‡ä»¶ä¸­</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º<span class="literal">false</span>ï¼Œéå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stdout_logfile=/a/path        ; å­è¿›ç¨‹çš„stdoutçš„æ—¥å¿—è·¯å¾„ï¼Œå¯ä»¥æŒ‡å®šè·¯å¾„ï¼ŒAUTOï¼Œnoneç­‰ä¸‰ä¸ªé€‰é¡¹ã€‚</span><br><span class="line"> </span><br><span class="line">                                 è®¾ç½®ä¸ºnoneçš„è¯ï¼Œå°†æ²¡æœ‰æ—¥å¿—äº§ç”Ÿã€‚è®¾ç½®ä¸ºAUTOçš„è¯ï¼Œå°†éšæœºæ‰¾ä¸€ä¸ªåœ°æ–¹</span><br><span class="line"> </span><br><span class="line">                                 ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸”å½“supervisordé‡æ–°å¯åŠ¨çš„æ—¶å€™ï¼Œä»¥å‰çš„æ—¥å¿—æ–‡ä»¶ä¼šè¢«</span><br><span class="line"> </span><br><span class="line">                                 æ¸…ç©ºã€‚å½“ redirect_stderr=<span class="literal">true</span>çš„æ—¶å€™ï¼Œsterrä¹Ÿä¼šå†™è¿›è¿™ä¸ªæ—¥å¿—æ–‡ä»¶</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_maxbytes=1MB   ; æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œå’Œ[supervisord]ä¸­å®šä¹‰çš„ä¸€æ ·ã€‚é»˜è®¤ä¸º50</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_backups=10     ; å’Œ[supervisord]å®šä¹‰çš„ä¸€æ ·ã€‚é»˜è®¤10</span><br><span class="line"> </span><br><span class="line">;stdout_capture_maxbytes=1MB   ; è¿™ä¸ªä¸œè¥¿æ˜¯è®¾å®šcaptureç®¡é“çš„å¤§å°ï¼Œå½“å€¼ä¸ä¸º0çš„æ—¶å€™ï¼Œå­è¿›ç¨‹å¯ä»¥ä»stdout</span><br><span class="line"> </span><br><span class="line">                                 å‘é€ä¿¡æ¯ï¼Œè€Œsupervisorå¯ä»¥æ ¹æ®ä¿¡æ¯ï¼Œå‘é€ç›¸åº”çš„eventã€‚</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º0ï¼Œä¸º0çš„æ—¶å€™è¡¨è¾¾å…³é—­ç®¡é“ã€‚ã€‚ã€‚éå¿…é¡»é¡¹</span><br><span class="line"> </span><br><span class="line">;stdout_events_enabled=<span class="literal">false</span>   ; å½“è®¾ç½®ä¸ºtureçš„æ—¶å€™ï¼Œå½“å­è¿›ç¨‹ç”±stdoutå‘æ–‡ä»¶æè¿°ç¬¦ä¸­å†™æ—¥å¿—çš„æ—¶å€™ï¼Œå°†</span><br><span class="line"> </span><br><span class="line">                                 è§¦å‘supervisordå‘é€PROCESS_LOG_STDOUTç±»å‹çš„event</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stderr_logfile=/a/path        ; è¿™ä¸ªä¸œè¥¿æ˜¯è®¾ç½®stderrå†™çš„æ—¥å¿—è·¯å¾„ï¼Œå½“redirect_stderr=<span class="literal">true</span>ã€‚è¿™ä¸ªå°±ä¸ç”¨</span><br><span class="line"> </span><br><span class="line">                                 è®¾ç½®äº†ï¼Œè®¾ç½®äº†ä¹Ÿæ˜¯ç™½æ­ã€‚å› ä¸ºå®ƒä¼šè¢«å†™å…¥stdout_logfileçš„åŒä¸€ä¸ªæ–‡ä»¶ä¸­</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸ºAUTOï¼Œä¹Ÿå°±æ˜¯éšä¾¿æ‰¾ä¸ªåœ°å­˜ï¼Œsupervisordé‡å¯è¢«æ¸…ç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_maxbytes=1MB   ; è¿™ä¸ªå‡ºç°å¥½å‡ æ¬¡äº†ï¼Œå°±ä¸é‡å¤äº†</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_backups=10     ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stderr_capture_maxbytes=1MB   ; è¿™ä¸ªä¸€æ ·ï¼Œå’Œstdout_captureä¸€æ ·ã€‚ é»˜è®¤ä¸º0ï¼Œå…³é—­çŠ¶æ€</span><br><span class="line"> </span><br><span class="line">;stderr_events_enabled=<span class="literal">false</span>   ; è¿™ä¸ªä¹Ÿæ˜¯ä¸€æ ·ï¼Œé»˜è®¤ä¸º<span class="literal">false</span></span><br><span class="line"> </span><br><span class="line">;environment=A=<span class="string">&quot;1&quot;</span>,B=<span class="string">&quot;2&quot;</span>       ; è¿™ä¸ªæ˜¯è¯¥å­è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œå’Œåˆ«çš„å­è¿›ç¨‹æ˜¯ä¸å…±äº«çš„</span><br><span class="line"> </span><br><span class="line">;serverurl=AUTO                ; </span><br><span class="line"> </span><br><span class="line">; The below sample eventlistener section shows all possible</span><br><span class="line"> </span><br><span class="line">; eventlistener subsection values, create one or more <span class="string">&#x27;real&#x27;</span></span><br><span class="line"> </span><br><span class="line">; eventlistener: sections to be able to handle event notifications</span><br><span class="line"> </span><br><span class="line">; sent by supervisor.</span><br><span class="line"> </span><br><span class="line">;[eventlistener:theeventlistenername] ;è¿™ä¸ªä¸œè¥¿å…¶å®å’Œprogramçš„åœ°ä½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯suopervisorå¯åŠ¨çš„å­è¿›</span><br><span class="line"> </span><br><span class="line">                                       ç¨‹ï¼Œä¸è¿‡å®ƒå¹²çš„æ´»æ˜¯è®¢é˜…supervisordå‘é€çš„eventã€‚ä»–çš„åå­—å°±å«</span><br><span class="line"> </span><br><span class="line">                                       listeneräº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨listeneré‡Œé¢åšä¸€ç³»åˆ—å¤„ç†ï¼Œæ¯”å¦‚æŠ¥è­¦ç­‰ç­‰</span><br><span class="line"> </span><br><span class="line">                                       æ¥¼ä¸»è¿™ä¸¤å¤©å¹²çš„æ´»ï¼Œå°±æ˜¯å¼„çš„è¿™ç©æ„</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">command</span>=/bin/eventlistener    ; è¿™ä¸ªå’Œä¸Šé¢çš„programä¸€æ ·ï¼Œè¡¨ç¤ºlistenerçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</span><br><span class="line"> </span><br><span class="line">;process_name=%(program_name)s ; è¿™ä¸ªä¹Ÿä¸€æ ·ï¼Œè¿›ç¨‹åï¼Œå½“ä¸‹é¢çš„numprocsä¸ºå¤šä¸ªçš„æ—¶å€™ï¼Œæ‰éœ€è¦ã€‚å¦åˆ™é»˜è®¤å°±</span><br><span class="line"> </span><br><span class="line">                                 OKäº†</span><br><span class="line"> </span><br><span class="line">;numprocs=1                    ; ç›¸åŒçš„listenerå¯åŠ¨çš„ä¸ªæ•°</span><br><span class="line"> </span><br><span class="line">;events=EVENT                  ; eventäº‹ä»¶çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å†™åœ¨è¿™ä¸ªåœ°æ–¹çš„äº‹ä»¶ç±»å‹ã€‚æ‰ä¼šè¢«å‘é€</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">;buffer_size=10                ; è¿™ä¸ªæ˜¯eventé˜Ÿåˆ—ç¼“å­˜å¤§å°ï¼Œå•ä½ä¸å¤ªæ¸…æ¥šï¼Œæ¥¼ä¸»çŒœæµ‹åº”è¯¥æ˜¯ä¸ªå§ã€‚å½“buffer</span><br><span class="line"> </span><br><span class="line">                                 è¶…è¿‡10çš„æ—¶å€™ï¼Œæœ€æ—§çš„eventå°†ä¼šè¢«æ¸…é™¤ï¼Œå¹¶æŠŠæ–°çš„eventæ”¾è¿›å»ã€‚</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤å€¼ä¸º10ã€‚ã€‚éå¿…é¡»é€‰é¡¹</span><br><span class="line"> </span><br><span class="line">;directory=/tmp                ; è¿›ç¨‹æ‰§è¡Œå‰ï¼Œä¼šåˆ‡æ¢åˆ°è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œ</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸ºä¸åˆ‡æ¢ã€‚ã€‚ã€‚éå¿…é¡»</span><br><span class="line"> </span><br><span class="line">;<span class="built_in">umask</span>=022                     ; æ·¹æ²¡ï¼Œé»˜è®¤ä¸ºnoneï¼Œä¸è¯´äº†</span><br><span class="line"> </span><br><span class="line">;priority=-1                   ; å¯åŠ¨ä¼˜å…ˆçº§ï¼Œé»˜è®¤-1ï¼Œä¹Ÿä¸æ‰¯äº†</span><br><span class="line"> </span><br><span class="line">;autostart=<span class="literal">true</span>                ; æ˜¯å¦éšsupervisordå¯åŠ¨ä¸€èµ·å¯åŠ¨ï¼Œé»˜è®¤<span class="literal">true</span></span><br><span class="line"> </span><br><span class="line">;autorestart=unexpected        ; æ˜¯å¦è‡ªåŠ¨é‡å¯ï¼Œå’Œprogramä¸€ä¸ªæ ·ï¼Œåˆ†<span class="literal">true</span>,<span class="literal">false</span>,unexpectedç­‰ï¼Œæ³¨æ„</span><br><span class="line"> </span><br><span class="line">                                  unexpectedå’Œexitcodesçš„å…³ç³»</span><br><span class="line"> </span><br><span class="line">;startsecs=1                   ; ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¿›ç¨‹å¯åŠ¨åè·‘äº†å‡ ç§’é’Ÿï¼Œæ‰è¢«è®¤å®šä¸ºæˆåŠŸå¯åŠ¨ï¼Œé»˜è®¤1</span><br><span class="line"> </span><br><span class="line">;startretries=3                ; å¤±è´¥æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œé»˜è®¤3</span><br><span class="line"> </span><br><span class="line">;exitcodes=0,2                 ; æœŸæœ›æˆ–è€…è¯´é¢„æ–™ä¸­çš„è¿›ç¨‹é€€å‡ºç ï¼Œ</span><br><span class="line"> </span><br><span class="line">;stopsignal=QUIT               ; å¹²æ‰è¿›ç¨‹çš„ä¿¡å·ï¼Œé»˜è®¤ä¸ºTERMï¼Œæ¯”å¦‚è®¾ç½®ä¸ºQUITï¼Œé‚£ä¹ˆå¦‚æœQUITæ¥å¹²è¿™ä¸ªè¿›ç¨‹</span><br><span class="line"> </span><br><span class="line">                                 é‚£ä¹ˆä¼šè¢«è®¤ä¸ºæ˜¯æ­£å¸¸ç»´æŠ¤ï¼Œé€€å‡ºç ä¹Ÿè¢«è®¤ä¸ºæ˜¯expectedä¸­çš„</span><br><span class="line"> </span><br><span class="line">;stopwaitsecs=10               ; max num secs to <span class="built_in">wait</span> b4 SIGKILL (default 10)</span><br><span class="line"> </span><br><span class="line">;stopasgroup=<span class="literal">false</span>             ; send stop signal to the UNIX process group (default <span class="literal">false</span>)</span><br><span class="line"> </span><br><span class="line">;killasgroup=<span class="literal">false</span>             ; SIGKILL the UNIX process group (def <span class="literal">false</span>)</span><br><span class="line"> </span><br><span class="line">;user=chrism                   ;è®¾ç½®æ™®é€šç”¨æˆ·ï¼Œå¯ä»¥ç”¨æ¥ç®¡ç†è¯¥listenerè¿›ç¨‹ã€‚</span><br><span class="line"> </span><br><span class="line">                                é»˜è®¤ä¸ºç©ºã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;redirect_stderr=<span class="literal">true</span>          ; ä¸º<span class="literal">true</span>çš„è¯ï¼Œstderrçš„<span class="built_in">log</span>ä¼šå¹¶å…¥stdoutçš„<span class="built_in">log</span>é‡Œé¢</span><br><span class="line"> </span><br><span class="line">                                é»˜è®¤ä¸º<span class="literal">false</span>ã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;stdout_logfile=/a/path        ; è¿™ä¸ªä¸è¯´äº†ï¼Œå¥½å‡ éäº†</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_maxbytes=1MB   ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stdout_logfile_backups=10     ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stdout_events_enabled=<span class="literal">false</span>   ; è¿™ä¸ªå…¶å®æ˜¯é”™çš„ï¼Œlisteneræ˜¯ä¸èƒ½å‘é€event</span><br><span class="line"> </span><br><span class="line">;stderr_logfile=/a/path        ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_maxbytes=1MB   ; è¿™ä¸ªä¹Ÿæ˜¯</span><br><span class="line"> </span><br><span class="line">;stderr_logfile_backups        ; è¿™ä¸ªä¸è¯´äº†</span><br><span class="line"> </span><br><span class="line">;stderr_events_enabled=<span class="literal">false</span>   ; è¿™ä¸ªä¹Ÿæ˜¯é”™çš„ï¼Œlistenerä¸èƒ½å‘é€event</span><br><span class="line"> </span><br><span class="line">;environment=A=<span class="string">&quot;1&quot;</span>,B=<span class="string">&quot;2&quot;</span>       ; è¿™ä¸ªæ˜¯è¯¥å­è¿›ç¨‹çš„ç¯å¢ƒå˜é‡</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤ä¸ºç©ºã€‚ã€‚ã€‚éå¿…é¡»è®¾ç½®</span><br><span class="line"> </span><br><span class="line">;serverurl=AUTO                ; override serverurl computation (childutils)</span><br><span class="line"> </span><br><span class="line">; The below sample group section shows all possible group values,</span><br><span class="line"> </span><br><span class="line">; create one or more <span class="string">&#x27;real&#x27;</span> group: sections to create <span class="string">&quot;heterogeneous&quot;</span></span><br><span class="line"> </span><br><span class="line">; process <span class="built_in">groups</span>.</span><br><span class="line"> </span><br><span class="line">;[group:thegroupname]  ;è¿™ä¸ªä¸œè¥¿å°±æ˜¯ç»™programsåˆ†ç»„ï¼Œåˆ’åˆ†åˆ°ç»„é‡Œé¢çš„programã€‚æˆ‘ä»¬å°±ä¸ç”¨ä¸€ä¸ªä¸€ä¸ªå»æ“ä½œäº†</span><br><span class="line"> </span><br><span class="line">                         æˆ‘ä»¬å¯ä»¥å¯¹ç»„åè¿›è¡Œç»Ÿä¸€çš„æ“ä½œã€‚ æ³¨æ„ï¼šprogramè¢«åˆ’åˆ†åˆ°ç»„é‡Œé¢ä¹‹åï¼Œå°±ç›¸å½“äºåŸæ¥</span><br><span class="line"> </span><br><span class="line">                         çš„é…ç½®ä»supervisorçš„é…ç½®æ–‡ä»¶é‡Œæ¶ˆå¤±äº†ã€‚ã€‚ã€‚supervisoråªä¼šå¯¹ç»„è¿›è¡Œç®¡ç†ï¼Œè€Œä¸å†</span><br><span class="line"> </span><br><span class="line">                         ä¼šå¯¹ç»„é‡Œé¢çš„å•ä¸ªprogramè¿›è¡Œç®¡ç†äº†</span><br><span class="line"> </span><br><span class="line">;programs=progname1,progname2  ; ç»„æˆå‘˜ï¼Œç”¨é€—å·åˆ†å¼€</span><br><span class="line"> </span><br><span class="line">                                 è¿™ä¸ªæ˜¯ä¸ªå¿…é¡»çš„è®¾ç½®é¡¹</span><br><span class="line"> </span><br><span class="line">;priority=999                  ; ä¼˜å…ˆçº§ï¼Œç›¸å¯¹äºç»„å’Œç»„ä¹‹é—´è¯´çš„</span><br><span class="line"> </span><br><span class="line">                                 é»˜è®¤999ã€‚ã€‚éå¿…é¡»é€‰é¡¹</span><br><span class="line"> </span><br><span class="line">; The [include] section can just contain the <span class="string">&quot;files&quot;</span> setting.  This</span><br><span class="line"> </span><br><span class="line">; setting can list multiple files (separated by whitespace or</span><br><span class="line"> </span><br><span class="line">; newlines).  It can also contain wildcards.  The filenames are</span><br><span class="line"> </span><br><span class="line">; interpreted as relative to this file.  Included files *cannot*</span><br><span class="line"> </span><br><span class="line">; include files themselves.</span><br><span class="line"> </span><br><span class="line">;[include]                         ;è¿™ä¸ªä¸œè¥¿æŒºæœ‰ç”¨çš„ï¼Œå½“æˆ‘ä»¬è¦ç®¡ç†çš„è¿›ç¨‹å¾ˆå¤šçš„æ—¶å€™ï¼Œå†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢</span><br><span class="line"> </span><br><span class="line">                                    å°±æœ‰ç‚¹å¤§äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠé…ç½®ä¿¡æ¯å†™åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åincludeè¿‡æ¥</span><br><span class="line"> </span><br><span class="line">;files = relative/directory/*.ini</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Supervisoræ§åˆ¶å°"><a href="#Supervisoræ§åˆ¶å°" class="headerlink" title="Supervisoræ§åˆ¶å°"></a>Supervisoræ§åˆ¶å°</h2><ul>
<li>åœ¨&#x2F;etc&#x2F;supervisord.confä¸­ä¿®æ”¹[inet_http_server]çš„å‚æ•°ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[inet_http_server]         ; inet (TCP) server disabled by default</span><br><span class="line">port=*:9001                ; ip_address:port specifier, *:port for all iface</span><br><span class="line">username=root              ; default is no username (open server)</span><br><span class="line">password=xxxx              ; default is no password (open server)</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¿®æ”¹åé‡å¯supervisorè¿›ç¨‹ï¼Œåœ¨æµè§ˆå™¨è®¿é—® <code>http://&lt;host-ip&gt;:9001</code></li>
</ul>
<h2 id="åˆ†ç»„ç®¡ç†"><a href="#åˆ†ç»„ç®¡ç†" class="headerlink" title="åˆ†ç»„ç®¡ç†"></a>åˆ†ç»„ç®¡ç†</h2><ul>
<li>Supervisor åŒæ—¶è¿˜æä¾›äº†å¦å¤–ä¸€ç§è¿›ç¨‹ç»„çš„ç®¡ç†æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ supervisorctl å‘½ä»¤æ¥ç®¡ç†ä¸€ç»„è¿›ç¨‹ï¼Œé€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹çš„é…ç½®ï¼Œå°†å¤šä¸ªæœåŠ¡æ·»åŠ è‡³åˆ†ç»„ä¸­</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[group:group_name]</span><br><span class="line">programs=progname1,progname2</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„:<ul>
<li>å½“æ·»åŠ äº†ä¸Šè¿°é…ç½®åï¼Œprogname1 å’Œ progname2 çš„è¿›ç¨‹åå°±ä¼šå˜æˆ group_name:progname1 å’Œ group_name:progname2 ä»¥åå°±è¦ç”¨è¿™ä¸ªåå­—æ¥ç®¡ç†è¿›ç¨‹äº†ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„ progname1ã€‚</li>
<li>ä»¥åæ‰§è¡Œ supervisorctl stop group_name: å°±èƒ½åŒæ—¶ç»“æŸ progname1 å’Œ progname2ï¼Œæ‰§è¡Œ supervisorctl stop group_name:progname1 å°±èƒ½ç»“æŸ progname1</li>
</ul>
</li>
</ul>
<h2 id="Supervisoré…ç½®å¼€æœºå¯åŠ¨"><a href="#Supervisoré…ç½®å¼€æœºå¯åŠ¨" class="headerlink" title="Supervisoré…ç½®å¼€æœºå¯åŠ¨"></a>Supervisoré…ç½®å¼€æœºå¯åŠ¨</h2><h3 id="æ–¹å¼ä¸€ï¼š"><a href="#æ–¹å¼ä¸€ï¼š" class="headerlink" title="æ–¹å¼ä¸€ï¼š"></a>æ–¹å¼ä¸€ï¼š</h3><ul>
<li>Linuxç¯å¢ƒä¸­ï¼šä»¥systemdçš„æ–¹å¼ç®¡ç†<ul>
<li>ç¼–å†™å¯åŠ¨è„šæœ¬ï¼švim &#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;supervisord</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/rc.d/init.d/supervisord</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Supervisor is a client/server system that</span></span><br><span class="line"><span class="comment"># allows its users to monitor and control a</span></span><br><span class="line"><span class="comment"># number of processes on UNIX-like operating</span></span><br><span class="line"><span class="comment"># systems.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chkconfig: - 64 36</span></span><br><span class="line"><span class="comment"># description: Supervisor Server</span></span><br><span class="line"><span class="comment"># processname: supervisord</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Source init functions</span></span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"></span><br><span class="line">prog=<span class="string">&quot;supervisord&quot;</span></span><br><span class="line"></span><br><span class="line">prefix=<span class="string">&quot;/usr&quot;</span></span><br><span class="line">exec_prefix=<span class="string">&quot;<span class="variable">$&#123;prefix&#125;</span>&quot;</span></span><br><span class="line">prog_bin=<span class="string">&quot;<span class="variable">$&#123;exec_prefix&#125;</span>/bin/supervisord&quot;</span></span><br><span class="line">PIDFILE=<span class="string">&quot;/var/run/<span class="variable">$prog</span>.pid&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">start</span></span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> -n $<span class="string">&quot;Starting <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">daemon <span class="variable">$prog_bin</span> --pidfile <span class="variable">$PIDFILE</span> -c /etc/supervisord.conf</span><br><span class="line">[ -f <span class="variable">$PIDFILE</span> ] &amp;&amp; success $<span class="string">&quot;<span class="variable">$prog</span> startup&quot;</span> || failure $<span class="string">&quot;<span class="variable">$prog</span> startup&quot;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">stop</span></span>()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> -n $<span class="string">&quot;Shutting down <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">[ -f <span class="variable">$PIDFILE</span> ] &amp;&amp; killproc <span class="variable">$prog</span> || success $<span class="string">&quot;<span class="variable">$prog</span> shutdown&quot;</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">start)</span><br><span class="line">start</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">stop)</span><br><span class="line">stop</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">status)</span><br><span class="line">status <span class="variable">$prog</span></span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">restart)</span><br><span class="line">stop</span><br><span class="line">start</span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Usage: <span class="variable">$0</span> &#123;start|stop|restart|status&#125;&quot;</span></span><br><span class="line">;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è®¾ç½®å¼€æœºå¯åŠ¨åŠsystemdæ–¹å¼å¯åŠ¨ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> +x /etc/rc.d/init.d/supervisord</span><br><span class="line"><span class="built_in">sudo</span> chkconfig --add supervisord</span><br><span class="line"><span class="built_in">sudo</span> chkconfig supervisord on</span><br><span class="line"><span class="built_in">sudo</span> service supervisord start</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹å¼äºŒï¼š"><a href="#æ–¹å¼äºŒï¼š" class="headerlink" title="æ–¹å¼äºŒï¼š"></a>æ–¹å¼äºŒï¼š</h3><blockquote>
<p>centos-7</p>
</blockquote>
<ul>
<li>è¿›å…¥ &#x2F; lib&#x2F;systemd&#x2F;system ç›®å½•ï¼Œå¹¶åˆ›å»º supervisord.service æ–‡ä»¶ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=supervisord</span><br><span class="line">After=network.target</span><br><span class="line"> </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/usr/bin/supervisord -c /etc/supervisor/supervisord.conf</span><br><span class="line">ExecStop=/usr/bin/supervisorctl <span class="variable">$OPTIONS</span> shutdown</span><br><span class="line">ExecReload=/usr/bin/supervisorctl <span class="variable">$OPTIONS</span> reload</span><br><span class="line">KillMode=process</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=42s</span><br><span class="line"> </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<ul>
<li>åŠ å…¥å¼€æœºå¯åŠ¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 766 /lib/systemd/system/supervisord.service</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl <span class="built_in">enable</span> supervisord.service</span><br><span class="line">systemctl start supervisord</span><br><span class="line">systemctl status supervisord</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ¡ˆä¾‹"><a href="#é…ç½®æ¡ˆä¾‹" class="headerlink" title="é…ç½®æ¡ˆä¾‹:"></a>é…ç½®æ¡ˆä¾‹:</h2><h3 id="Djangoçš„é…ç½®æ–‡ä»¶"><a href="#Djangoçš„é…ç½®æ–‡ä»¶" class="headerlink" title="Djangoçš„é…ç½®æ–‡ä»¶"></a>Djangoçš„é…ç½®æ–‡ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#é¡¹ç›®å</span><br><span class="line">[program:django]</span><br><span class="line">#è„šæœ¬ç›®å½•</span><br><span class="line">directory=/root/social_engineering/</span><br><span class="line">#è„šæœ¬æ‰§è¡Œå‘½ä»¤</span><br><span class="line">command=/root/anaconda3/bin/python manage.py runserver 0.0.0.0:8000</span><br><span class="line"></span><br><span class="line">#supervisorå¯åŠ¨çš„æ—¶å€™æ˜¯å¦éšç€åŒæ—¶å¯åŠ¨ï¼Œé»˜è®¤True</span><br><span class="line">autostart=true</span><br><span class="line">#å½“ç¨‹åºexitçš„æ—¶å€™ï¼Œè¿™ä¸ªprogramä¸ä¼šè‡ªåŠ¨é‡å¯,é»˜è®¤unexpectedï¼Œè®¾ç½®å­è¿›ç¨‹æŒ‚æ‰åè‡ªåŠ¨é‡å¯çš„æƒ…å†µï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹ï¼Œfalse,unexpectedå’Œtrueã€‚å¦‚æœä¸ºfalseçš„æ—¶å€™ï¼Œæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹ï¼Œéƒ½ä¸ä¼šè¢«é‡æ–°å¯åŠ¨ï¼Œå¦‚æœä¸ºunexpectedï¼Œåªæœ‰å½“è¿›ç¨‹çš„</span><br><span class="line">é€€å‡ºç ä¸åœ¨ä¸‹é¢çš„exitcodesé‡Œé¢å®šä¹‰çš„</span><br><span class="line">autorestart=true</span><br><span class="line">#è¿™ä¸ªé€‰é¡¹æ˜¯å­è¿›ç¨‹å¯åŠ¨å¤šå°‘ç§’ä¹‹åï¼Œæ­¤æ—¶çŠ¶æ€å¦‚æœæ˜¯runningï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºå¯åŠ¨æˆåŠŸäº†ã€‚é»˜è®¤å€¼ä¸º1</span><br><span class="line">startsecs=1</span><br><span class="line"></span><br><span class="line">#è„šæœ¬è¿è¡Œçš„ç”¨æˆ·èº«ä»½ </span><br><span class="line"></span><br><span class="line">#æ—¥å¿—è¾“å‡º </span><br><span class="line">stderr_logfile=/tmp/django_stderr.log</span><br><span class="line">stdout_logfile=/tmp/django_stdout.log</span><br><span class="line">#æŠŠstderré‡å®šå‘åˆ°stdoutï¼Œé»˜è®¤ false</span><br><span class="line">redirect_stderr = true</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MB</span><br><span class="line">stdout_logfile_maxbytes = 20</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°</span><br><span class="line">stdout_logfile_backups = 20</span><br><span class="line"></span><br><span class="line">; å¯ä»¥é€šè¿‡ environment æ¥æ·»åŠ éœ€è¦çš„ç¯å¢ƒå˜é‡ï¼Œä¸€ç§å¸¸è§çš„ç”¨æ³•æ˜¯ä¿®æ”¹ PYTHONPATH</span><br><span class="line">; environment=PYTHONPATH=$PYTHONPATH:/path/to/somewhere</span><br></pre></td></tr></table></figure>

<h3 id="Celeryçš„é…ç½®æ–‡ä»¶"><a href="#Celeryçš„é…ç½®æ–‡ä»¶" class="headerlink" title="Celeryçš„é…ç½®æ–‡ä»¶"></a>Celeryçš„é…ç½®æ–‡ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#é¡¹ç›®å</span><br><span class="line">[program:celery]</span><br><span class="line">#è„šæœ¬ç›®å½•</span><br><span class="line">directory=/root/social_engineering/</span><br><span class="line">#è„šæœ¬æ‰§è¡Œå‘½ä»¤</span><br><span class="line">command=/root/anaconda3/bin/celery -A tasks worker --loglevel=info</span><br><span class="line"></span><br><span class="line">#supervisorå¯åŠ¨çš„æ—¶å€™æ˜¯å¦éšç€åŒæ—¶å¯åŠ¨ï¼Œé»˜è®¤True</span><br><span class="line">autostart=true</span><br><span class="line">#ç¨‹åºå´©æºƒæ—¶è‡ªåŠ¨é‡å¯</span><br><span class="line">autorestart=true</span><br><span class="line">#è¿™ä¸ªé€‰é¡¹æ˜¯å­è¿›ç¨‹å¯åŠ¨å¤šå°‘ç§’ä¹‹åï¼Œæ­¤æ—¶çŠ¶æ€å¦‚æœæ˜¯runningï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºå¯åŠ¨æˆåŠŸäº†ã€‚é»˜è®¤å€¼ä¸º1</span><br><span class="line">startsecs=1</span><br><span class="line"></span><br><span class="line">#è„šæœ¬è¿è¡Œçš„ç”¨æˆ·èº«ä»½ </span><br><span class="line"></span><br><span class="line">#æ—¥å¿—è¾“å‡º </span><br><span class="line">stderr_logfile=/tmp/celery_stderr.log</span><br><span class="line">stdout_logfile=/tmp/celery_stdout.log</span><br><span class="line">#æŠŠstderré‡å®šå‘åˆ°stdoutï¼Œé»˜è®¤ false</span><br><span class="line">redirect_stderr = true</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MB</span><br><span class="line">stdout_logfile_maxbytes = 20</span><br><span class="line">#stdoutæ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°</span><br><span class="line">stdout_logfile_backups = 20</span><br></pre></td></tr></table></figure>

<h3 id="Redisçš„é…ç½®æ–‡ä»¶"><a href="#Redisçš„é…ç½®æ–‡ä»¶" class="headerlink" title="Redisçš„é…ç½®æ–‡ä»¶"></a>Redisçš„é…ç½®æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[program:zedis]</span><br><span class="line"><span class="built_in">command</span>=/opt/zedis/redis-server /opt/zedis/redis.conf</span><br><span class="line">user=redisuser</span><br><span class="line">autostart=<span class="literal">true</span> 								</span><br><span class="line">;å¯åŠ¨supervisordçš„æ—¶å€™ä¼šå°†è¯¥é…ç½®é¡¹è®¾ç½®ä¸º<span class="literal">true</span>çš„æ‰€æœ‰è¿›ç¨‹è‡ªåŠ¨å¯åŠ¨</span><br><span class="line">stopasgroup=<span class="literal">true</span>							</span><br><span class="line">;ä½¿ç”¨supervisorctlåœæ­¢zedisæ—¶ï¼Œå­è¿›ç¨‹ä¹Ÿä¼šä¸€èµ·åœæ­¢</span><br><span class="line">killasgroup=<span class="literal">true</span>							</span><br><span class="line">;å‘è¿›ç¨‹ç»„å‘é€<span class="built_in">kill</span>ä¿¡å·ï¼ŒåŒ…æ‹¬å­è¿›ç¨‹</span><br><span class="line">startsecs=10								</span><br><span class="line">;è¿›ç¨‹ä»STARINGçŠ¶æ€è½¬æ¢åˆ°RUNNINGçŠ¶æ€æ‰€éœ€è¦ä¿æŒè¿è¡Œ10sæ—¶é—´</span><br><span class="line">startretries=3								</span><br><span class="line">;å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯3</span><br><span class="line">autorestart=<span class="literal">true</span>							</span><br><span class="line">;è¿›ç¨‹åœæ­¢åè‡ªåŠ¨å¯åŠ¨</span><br><span class="line">stdout_logfile=/var/log/zedis-out</span><br><span class="line">stdout_logfile_maxbytes=1MB</span><br><span class="line">stdout_logfile_backups=10</span><br><span class="line">stderr_logfile=/var/log/zedis-err</span><br><span class="line">stderr_logfile_maxbytes=1MB</span><br><span class="line">stderr_logfile_backups=10</span><br></pre></td></tr></table></figure>

<ul>
<li>Ã˜ å› ä¸ºæ— æ³•ç›‘è§†åå°è¿›ç¨‹ï¼Œéœ€è¦æŠŠZediså‰å°è¿è¡Œï¼ˆdaemonize noï¼‰ï¼Œå¦åˆ™ä¼šè¯†åˆ«ä¸åˆ°Zediså¯åŠ¨ï¼Œé‡è¯•å¯åŠ¨3æ¬¡,æ—¥å¿—æç¤º6379å·²å ç”¨ã€‚</li>
<li>Ã˜ å› ä¸ºredis.confæŒ‡å®šäº†logfileï¼Œstdout_logfileå¹¶æ— å†…å®¹è¾“å‡ºï¼›å¦‚æœä¸æŒ‡å®šredis.confåªæ˜¯å¯åŠ¨redis-serverï¼Œæ—¥å¿—ä¼šè¾“å‡ºåˆ°stdout_logfileã€‚</li>
</ul>
<h3 id="tomcatçš„é…ç½®æ–‡ä»¶"><a href="#tomcatçš„é…ç½®æ–‡ä»¶" class="headerlink" title="tomcatçš„é…ç½®æ–‡ä»¶"></a>tomcatçš„é…ç½®æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[program:tomcat]</span><br><span class="line"><span class="built_in">command</span>=/usr/local/tomcat/bin/catalina.sh run</span><br><span class="line">stdout_logfile=/usr/local/tomcat/logs/catalina.out</span><br><span class="line">stderr_logfile=/usr/local/tomcat/logs/catalina.out</span><br><span class="line">environment=JAVA_HOME=<span class="string">&quot;/usr/local/jdk1.8.0_144&quot;</span>,JAVA_BIN=<span class="string">&quot;/usr/local/jdk1.8.0_144/bin&quot;</span></span><br><span class="line">autorestart=<span class="literal">false</span></span><br><span class="line">startsecs=60</span><br><span class="line">priority=1</span><br><span class="line">stopasgroup=<span class="literal">true</span></span><br><span class="line">killasgroup=<span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶"><a href="#åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶" class="headerlink" title="åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶"></a>åˆ†ç»„ç®¡ç†çš„é…ç½®æ–‡ä»¶</h2><ul>
<li>æ–°å»ºæ–‡ä»¶ï¼Œfastapi_app.conf</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[group:fastapi]</span><br><span class="line">programs=fastapi-app</span><br><span class="line"></span><br><span class="line">[program:fastapi-1]</span><br><span class="line">command=/home/python/scripts/fastapi1_app.sh</span><br><span class="line">directory=/home/python/fastapi-1-backend</span><br><span class="line">user=python</span><br><span class="line">autorestart=true</span><br><span class="line">redirect_stderr=false</span><br><span class="line">loglevel=info</span><br><span class="line">stopsignal=KILL</span><br><span class="line">stopasgroup=true</span><br><span class="line">killasgroup=true</span><br><span class="line"></span><br><span class="line">[program:fastapi-2]</span><br><span class="line">command=/home/python/scripts/fastapi-2.sh</span><br><span class="line">directory=/home/python/fastapi-2-backend</span><br><span class="line">user=python</span><br><span class="line">autorestart=true</span><br><span class="line">redirect_stderr=false</span><br><span class="line">loglevel=info</span><br><span class="line">stopsignal=KILL</span><br><span class="line">stopasgroup=true</span><br><span class="line">killasgroup=true</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸è§é—®é¢˜ï¼š"><a href="#å¸¸è§é—®é¢˜ï¼š" class="headerlink" title="å¸¸è§é—®é¢˜ï¼š"></a>å¸¸è§é—®é¢˜ï¼š</h2><h3 id="é—®é¢˜1ï¼šunix-tmp-supervisor-sock-no-such-fileçš„é—®é¢˜"><a href="#é—®é¢˜1ï¼šunix-tmp-supervisor-sock-no-such-fileçš„é—®é¢˜" class="headerlink" title="é—®é¢˜1ï¼šunix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock no such fileçš„é—®é¢˜"></a>é—®é¢˜1ï¼šunix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock no such fileçš„é—®é¢˜</h3><ul>
<li>åœ¨supervisoré»˜è®¤é…ç½®ä¸­ï¼Œå…¶å¯åŠ¨çš„sockç­‰éƒ½ä¼šæ”¾åˆ°tmpç›®å½•ï¼Œè€Œtmpç›®å½•ä¼šè‡ªåŠ¨æ¸…ç†å¯¼è‡´æ— æ³•ä½¿ç”¨supervisorctl</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/supervisord.conf</span><br><span class="line"></span><br><span class="line">#step1: å°†é…ç½®æ–‡ä»¶ä¸­çš„tmpæ›¿æ¢æ‰ï¼Œå¦åˆ™å®¹æ˜“è¢«linuxè‡ªåŠ¨æ¸…é™¤</span><br><span class="line">/tmp/supervisor.sock æ”¹æˆ /var/run/supervisor.sockï¼Œ</span><br><span class="line">/tmp/supervisord.log æ”¹æˆ /var/log/supervisor.logï¼Œ</span><br><span class="line">/tmp/supervisord.pid æ”¹æˆ /var/run/supervisor.pid</span><br><span class="line"></span><br><span class="line"># step2:ä¿®æ”¹æƒé™ï¼Œå¦‚æœä¸ä¿®æ”¹ï¼Œå¯åŠ¨æ—¶ä¼šæŠ¥é”™æ— æƒé™</span><br><span class="line">sudo chmod 777 /run</span><br><span class="line">sudo chmod 777 /var/log</span><br><span class="line"></span><br><span class="line"># step3: åˆ›å»ºsupervisor.sock</span><br><span class="line">sudo touch /var/run/supervisor.sock</span><br><span class="line">sudo chmod 777 /var/run/supervisor.sock</span><br><span class="line"></span><br><span class="line"># step4: æ€æ‰åŸæ¥çš„è¿›ç¨‹ï¼Œé‡æ–°å¯åŠ¨</span><br><span class="line">supervisord -c /etc/supervisord.conf</span><br></pre></td></tr></table></figure>

<h3 id="é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯"><a href="#é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯" class="headerlink" title="é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯"></a>é—®é¢˜2ï¼šcommandä¸­æŒ‡å®šçš„è¿›ç¨‹å·²ç»èµ·æ¥ï¼Œä½†supervisorè¿˜ä¸æ–­é‡å¯</h3><ul>
<li>commandä¸­å¯åŠ¨æ–¹å¼ä¸ºåå°å¯åŠ¨ï¼Œå¯¼è‡´è¯†åˆ«ä¸åˆ°pidï¼Œç„¶åä¸æ–­é‡å¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯elasticsearchï¼ŒcommandæŒ‡å®šçš„æ˜¯$path&#x2F;bin&#x2F;elasticsearch -d</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§£å†³åŠæ³•ï¼šsupervisoræ— æ³•æ£€æµ‹åå°å¯åŠ¨è¿›ç¨‹çš„pidï¼Œè€Œsupervisoræœ¬èº«å°±æ˜¯åå°å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒè¿™ä¸ª</span><br></pre></td></tr></table></figure>

<h3 id="é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡"><a href="#é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡" class="headerlink" title="é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡"></a>é—®é¢˜3ï¼šå¯åŠ¨äº†å¤šä¸ªsupervisordæœåŠ¡ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸å…³é—­æœåŠ¡</h3><ul>
<li>åœ¨è¿è¡Œsupervisord -c &#x2F;etc&#x2F;supervisord.confä¹‹å‰ï¼Œç›´æ¥è¿è¡Œè¿‡supervisord -c &#x2F;etc&#x2F;supervisord.d&#x2F;xx.confå¯¼è‡´æœ‰äº›è¿›ç¨‹è¢«å¤šä¸ªsuperviordç®¡ç†ï¼Œæ— æ³•æ­£å¸¸å…³é—­è¿›ç¨‹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§£å†³åŠæ³•ï¼šä½¿ç”¨ps -fe | grep supervisordæŸ¥çœ‹æ‰€æœ‰å¯åŠ¨è¿‡çš„supervisordæœåŠ¡ï¼Œ<span class="built_in">kill</span>ç›¸å…³çš„è¿›ç¨‹ã€‚</span><br></pre></td></tr></table></figure>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2025-03-04</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« sswfive</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/python%E5%BA%93/'>
                            pythonåº“
                        </a>
                    
                        <a href='/tags/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/'>
                            è¿›ç¨‹ç®¡ç†
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/Python/'>
                            Python
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>ä¸Šä¸€ç¯‡ï¼š<a href='/2025/03/04/10-subprocess/'>å­è¿›ç¨‹ç®¡ç†å·¥å…·ä¹‹subprocess</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">ä¸‹ä¸€ç¯‡ï¼š<a href="/2025/03/04/08-apscheduler/">ä»»åŠ¡ç®¡ç†å·¥å…·ä¹‹APScheduler</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            Â© 2018ï½2025 China 

            
                

            
        </span>
       
    
</div>



<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // å¯ç”¨æ’ä»¶
            thumbnail: true,          // æ˜¾ç¤ºç¼©ç•¥å›¾
            zoom: true,               // å¯ç”¨ç¼©æ”¾åŠŸ
            rotate: true,             // å¯ç”¨æ—‹è½¬åŠŸèƒ½èƒ½
            autoplay: true,        // å¯ç”¨è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½
            fullScreen: true,      // å¯ç”¨å…¨å±åŠŸèƒ½
            pager: false, //é¡µç ,
            zoomFromOrigin: true,   // ä»åŸå§‹ä½ç½®ç¼©æ”¾
            actualSize: true,       // å¯ç”¨æŸ¥çœ‹å®é™…å¤§å°çš„åŠŸèƒ½
            enableZoomAfter: 300,    // å»¶è¿Ÿç¼©æ”¾ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆåå¯ç¼©æ”¾
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // ä¿®å¤é€‰æ‹©å™¨
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>
>>>>>>> d637c7874a7bc509e9a34c59b8da582945ee617c
